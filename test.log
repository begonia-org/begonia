?   	github.com/begonia-org/begonia	[no test files]
?   	github.com/begonia-org/begonia/cmd/gateway	[no test files]
?   	github.com/begonia-org/begonia/config	[no test files]
?   	github.com/begonia-org/begonia/internal	[no test files]
?   	github.com/begonia-org/begonia/internal/auth	[no test files]
?   	github.com/begonia-org/begonia/internal/daemon	[no test files]
?   	github.com/begonia-org/begonia/internal/pkg	[no test files]
?   	github.com/begonia-org/begonia/internal/pkg/config	[no test files]
?   	github.com/begonia-org/begonia/internal/pkg/middleware	[no test files]
?   	github.com/begonia-org/begonia/internal/pkg/errors	[no test files]
?   	github.com/begonia-org/begonia/internal/pkg/migrate	[no test files]
?   	github.com/begonia-org/begonia/internal/pkg/routers	[no test files]
?   	github.com/begonia-org/begonia/internal/pkg/runtime	[no test files]
?   	github.com/begonia-org/begonia/internal/pkg/crypto	[no test files]
?   	github.com/begonia-org/begonia/internal/pkg/middleware/auth	[no test files]
?   	github.com/begonia-org/begonia/internal/pkg/utils	[no test files]
?   	github.com/begonia-org/begonia/internal/server	[no test files]
=== RUN   TestRequest

  test request [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
4 total assertions[0m

--- PASS: TestRequest (3.00s)
=== RUN   TestFormDataContentType

  TestFormDataContentType [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
20 total assertions[0m

--- PASS: TestFormDataContentType (0.00s)
=== RUN   TestFormUrlEncodedContentType

  TestFormUrlEncodedContentType [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
26 total assertions[0m

--- PASS: TestFormUrlEncodedContentType (0.00s)
=== RUN   TestFormUrlEncodedErr

  TestFormUrlEncodedErr [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
28 total assertions[0m

--- PASS: TestFormUrlEncodedErr (0.00s)
=== RUN   TestFormDataDecodeErr

  TestFormDataDecodeErr [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
36 total assertions[0m

--- PASS: TestFormDataDecodeErr (0.00s)
=== RUN   TestFormDataValueErr

  test formdata value err [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
45 total assertions[0m

--- PASS: TestFormDataValueErr (0.00s)
=== RUN   TestHttp
=== RUN   TestHttp/testRegisterClient

  test register client [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/05/20 01:24:39 Start on 127.0.0.1:6435


[31m[0m[33m[0m[32m
55 total assertions[0m

=== RUN   TestHttp/testRequestGet

  test request GET [32m✔[0m2024/05/20 01:24:42 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
{"elapsed":"1.338357ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-05-20 01:24:42","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"6a83ba86-6fd5-41a3-9d80-6a847ed8ccdc","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/05/20 01:24:42 /api/v1/example/http-code?msg=hello,params:map[msg:[hello] name:[http-code]]
{"elapsed":"878.418µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-05-20 01:24:42","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/http-code?msg=hello","x-request-id":"2eb5c2fb-551c-4797-9117-e66f12c79618","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
68 total assertions[0m

=== RUN   TestHttp/testCors

  test cors [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":71,"message":"origin:http://www.begonia-org.com not allowed","timestamp":"2024-05-20 01:24:42"}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
75 total assertions[0m

=== RUN   TestHttp/testRequestPost

  test request POST json [32m✔[0m2024/05/20 01:24:42 /api/v1/example/post,params:map[]
{"elapsed":"855.578µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHello","status":200,"timestamp":"2024-05-20 01:24:42","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/post","x-request-id":"2ae52786-e340-4fb0-8041-1ac1fc78087b","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
82 total assertions[0m


  test request POST form-data [32m✔[0m[32m✔[0m2024/05/20 01:24:42 /api/v1/example/post,params:map[]
{"elapsed":"838.35µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHello","status":200,"timestamp":"2024-05-20 01:24:42","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/post","x-request-id":"29680aeb-30fe-4aed-97f8-193b0ec131a9","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
90 total assertions[0m


  test request POST form-urlencoded [32m✔[0m2024/05/20 01:24:42 /api/v1/example/post,params:map[]
{"elapsed":"802.131µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHello","status":200,"timestamp":"2024-05-20 01:24:42","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/post","x-request-id":"5dc55fec-0146-4ba2-a3e7-c7c74f3e6ed3","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
97 total assertions[0m


  test request POST binary [32m✔[0m2024/05/20 01:24:42 /api/v1/example/body,params:map[]
{"elapsed":"1.649245ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloBody","status":200,"timestamp":"2024-05-20 01:24:42","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/body","x-request-id":"68fd22ad-ce3b-45d7-83ab-bc44779aa767","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
105 total assertions[0m

=== RUN   TestHttp/testServerSideEvent

  test server side event 2024/05/20 01:24:42 /api/v1/example/server/sse/world?msg=hello&stream=message,params:map[msg:[hello] name:[world] stream:[message]]
{"elapsed":"1.11675ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloServerSideEvent","status":200,"timestamp":"2024-05-20 01:24:42","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/sse/world?msg=hello\u0026stream=message","x-request-id":"4161ffc7-d250-4753-b0f8-da0b166a8a51","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
126 total assertions[0m

=== RUN   TestHttp/testWebsocket

  test websocket [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
167 total assertions[0m

=== RUN   TestHttp/testClientStreamRequest

  test client stream request [32m✔[0m{"elapsed":"3.090837ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloWebsocket","status":200,"timestamp":"2024-05-20 01:24:42","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/websocket","x-request-id":"713d38e2-9fd5-4a09-b375-24a0146948b8","x-uid":""}
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
{"elapsed":"896.735µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":200,"timestamp":"2024-05-20 01:24:42","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"4cc45287-3ef3-46af-9548-6a22de6e2357","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
183 total assertions[0m

=== RUN   TestHttp/testClientStreamRequestByMarshal

  test client stream request [32m✔[0m2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
2024/05/20 01:24:42 /api/v1/example/client/stream,params:map[]
{"elapsed":"855.857µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":200,"timestamp":"2024-05-20 01:24:42","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"a225533d-0514-42d9-bde0-f3b0b7d637da","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
199 total assertions[0m

=== RUN   TestHttp/testLoadGlobalTypes

  test load global types [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
206 total assertions[0m

=== RUN   TestHttp/testUpdateLoadbalance

  test update loadbalance [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/05/20 01:24:45 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
2024/05/20 01:24:45 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
2024/05/20 01:24:45 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
2024/05/20 01:24:45 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
2024/05/20 01:24:45 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
2024/05/20 01:24:45 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
2024/05/20 01:24:45 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
2024/05/20 01:24:45 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
2024/05/20 01:24:45 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
2024/05/20 01:24:45 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
{"elapsed":"5.566916ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"9f8b9ffc-bc05-4973-9e7b-5936a400e171","x-uid":""}
{"elapsed":"6.151723ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"521b8934-d1da-437c-aab3-7c99d32542c7","x-uid":""}
{"elapsed":"3.15613ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"f8a5a024-42bf-473a-a6d5-17c92f53785e","x-uid":""}
{"elapsed":"4.435043ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"a451cbe2-7146-4e66-b477-708dad901c1b","x-uid":""}
{"elapsed":"4.232365ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"be6ce61a-8ef6-452b-b2b5-cc07bc5a9dcb","x-uid":""}
{"elapsed":"4.381976ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"8ab9c9aa-e50a-4e42-8182-36c036a3b67d","x-uid":""}
{"elapsed":"4.593587ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"2e38cf36-af14-486d-8051-4f56cd438a23","x-uid":""}
{"elapsed":"4.963496ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"769c8c2c-8415-42a3-ac78-dead8907c951","x-uid":""}
{"elapsed":"4.431498ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"98772cfd-2ac7-47f9-9134-ea44d3b34b8d","x-uid":""}
{"elapsed":"31.281499ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"25d7e8c6-00cf-4279-b0c9-ef8798f03f65","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
229 total assertions[0m

=== RUN   TestHttp/testHttpError

  test http error [32m✔[0m[32m✔[0m2024/05/20 01:24:45 /api/v1/example/error/test?msg=ok&code=0,params:map[code:[0] msg:[ok]]
2024/05/20 01:24:45 SayHelloError: ok,code:0
{"elapsed":"842.784µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloError","status":200,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=0","x-request-id":"20fa9310-6e6f-4c93-b41d-204bd1f22d71","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/05/20 01:24:45 /api/v1/example/error/test?msg=ok&code=13,params:map[code:[13] msg:[ok]]
2024/05/20 01:24:45 SayHelloError: ok,code:13
{"elapsed":"844.681µs","file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":145,"message":"rpc error: code = Internal desc = ok","module":"request","name":"/helloworld.Greeter/SayHelloError","status":5000,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=13","x-request-id":"ae74b3cd-42b0-447a-a208-ba80ae6af9ba","x-uid":""}
{"file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":145,"message":"ok","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/05/20 01:24:45 /api/v1/example/error/test?msg=ok&code=3,params:map[code:[3] msg:[ok]]
2024/05/20 01:24:45 SayHelloError: ok,code:3
{"elapsed":"873.913µs","file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":142,"message":"rpc error: code = InvalidArgument desc = ok","module":"request","name":"/helloworld.Greeter/SayHelloError","status":4000,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=3","x-request-id":"e19154ab-1e1d-459e-bea0-218921ac9809","x-uid":""}
{"file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":142,"message":"ok","status":400,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/05/20 01:24:45 /api/v1/example/error/test?msg=ok&code=5,params:map[code:[5] msg:[ok]]
2024/05/20 01:24:45 SayHelloError: ok,code:5
{"elapsed":"818.77µs","file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":147,"message":"rpc error: code = NotFound desc = ok","module":"request","name":"/helloworld.Greeter/SayHelloError","status":4004,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=5","x-request-id":"4ee35fc0-0771-402f-a1b1-872fbb94919f","x-uid":""}
{"file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":147,"message":"ok","status":404,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/05/20 01:24:45 /api/v1/example/error/test?msg=ok&code=7,params:map[code:[7] msg:[ok]]
2024/05/20 01:24:45 SayHelloError: ok,code:7
{"elapsed":"889.999µs","file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":149,"message":"rpc error: code = PermissionDenied desc = ok","module":"request","name":"/helloworld.Greeter/SayHelloError","status":4001,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=7","x-request-id":"ea0fdc75-e298-4739-ac27-6d165881c564","x-uid":""}
{"file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":149,"message":"ok","status":403,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/05/20 01:24:45 /api/v1/example/error/test?msg=ok&code=16,params:map[code:[16] msg:[ok]]
2024/05/20 01:24:45 SayHelloError: ok,code:16
{"elapsed":"2.472977ms","file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":151,"message":"rpc error: code = Unauthenticated desc = ok","module":"request","name":"/helloworld.Greeter/SayHelloError","status":4001,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=16","x-request-id":"d7d88d01-1776-4113-a030-bd1a21dc0bba","x-uid":""}
{"file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":151,"message":"ok","status":401,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/05/20 01:24:45 /api/v1/example/error/test?msg=ok&code=8,params:map[code:[8] msg:[ok]]
2024/05/20 01:24:45 SayHelloError: ok,code:8
{"elapsed":"897.505µs","file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":161,"message":"rpc error: code = ResourceExhausted desc = ok","module":"request","name":"/helloworld.Greeter/SayHelloError","status":4008,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=8","x-request-id":"1faafc29-2d72-44c2-be6b-0fbbedab807f","x-uid":""}
{"file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":161,"message":"ok","status":429,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/05/20 01:24:45 /api/v1/example/error/test?msg=ok&code=4,params:map[code:[4] msg:[ok]]
2024/05/20 01:24:45 SayHelloError: ok,code:4
{"elapsed":"854.887µs","file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":159,"message":"rpc error: code = DeadlineExceeded desc = ok","module":"request","name":"/helloworld.Greeter/SayHelloError","status":5004,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=4","x-request-id":"11532e80-3613-47b7-9e4c-67e5eb1c7014","x-uid":""}
{"file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":159,"message":"ok","status":504,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
261 total assertions[0m

=== RUN   TestHttp/testWebSocketError

  test websocket error [32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"WARNING","line":472,"message":"Failed to start websocket request: Failed to start websocket request: test stream error","timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"WARNING","line":472,"message":"Failed to start websocket request: Failed to get header from websocket client: test header error","timestamp":"2024-05-20 01:24:45"}
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func2","level":"WARNING","line":189,"message":"Failed to send websocket request: read tcp 127.0.0.1:6435-\u003e127.0.0.1:45264: use of closed network connection","timestamp":"2024-05-20 01:24:45"}
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func2","level":"WARNING","line":189,"message":"Failed to send websocket request: test send error","timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"elapsed":"878.297µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Canceled desc = context canceled","module":"request","name":"/helloworld.Greeter/SayHelloWebsocket","status":499,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/websocket","x-request-id":"dc3ae04c-46a4-4ba9-b7c1-4dd00977e282","x-uid":""}
[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func2","level":"WARNING","line":189,"message":"Failed to send websocket request: Failed to decode websocket request: test BIN DECODE error","timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func2","level":"WARNING","line":189,"message":"Failed to send websocket request: Failed to send request: test send error","timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"ERROR","line":463,"message":"Failed to upgrade to websocket: test upgrade error","timestamp":"2024-05-20 01:24:45"}
{"elapsed":"1.017787ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloWebsocket","status":200,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/websocket","x-request-id":"ccf05ab6-8c7f-4694-b1c0-5fe794e13386","x-uid":""}
[32m✔[0m[32m✔[0m[32m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"WARNING","line":472,"message":"Failed to start websocket request: Failed to start websocket request: test get conn error","timestamp":"2024-05-20 01:24:45"}
✔[0m[32m✔[0m[32m✔[0m{"elapsed":"1.041785ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloWebsocket","status":200,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/websocket","x-request-id":"648ba964-b7f9-40c4-b932-75143061e1fb","x-uid":""}
{"elapsed":"808.173µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloWebsocket","status":200,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/websocket","x-request-id":"8ac8a94a-b693-427f-85f7-21005b78a8f5","x-uid":""}
[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"WARNING","line":472,"message":"Failed to start websocket request: Failed to start websocket request: test new stream error","timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
290 total assertions[0m

=== RUN   TestHttp/testServerSideEventErr

  test server side event error {"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":284,"message":"error type:*fmt.wrapError, error:Failed to add request params: test inParamsHandle error","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m2024/05/20 01:24:45 /api/v1/example/server/sse/world?msg=hello&stream=message,params:map[msg:[hello] name:[world] stream:[message]]
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":284,"message":"error type:*fmt.wrapError, error:Failed to start streaming: test ServerSideStream error","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m2024/05/20 01:24:45 /api/v1/example/server/sse/world?msg=hello&stream=message,params:map[msg:[hello] name:[world] stream:[message]]
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":284,"message":"error type:*fmt.wrapError, error:Failed to get header from client: test header error","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m2024/05/20 01:24:45 /api/v1/example/server/sse/world?msg=hello&stream=message,params:map[msg:[hello] name:[world] stream:[message]]
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":284,"message":"error type:*fmt.wrapError, error:Failed to start streaming: test get conn error","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m2024/05/20 01:24:45 /api/v1/example/server/sse/world?msg=hello&stream=message,params:map[msg:[hello] name:[world] stream:[message]]
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":284,"message":"error type:*fmt.wrapError, error:Failed to start streaming: test new stream error","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m2024/05/20 01:24:45 /api/v1/example/server/sse/world?msg=hello&stream=message,params:map[msg:[hello] name:[world] stream:[message]]
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":284,"message":"error type:*fmt.wrapError, error:Failed to start streaming: test send error","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m

[31m[0m[33m[0m[32m
296 total assertions[0m

{"elapsed":"21.208µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Unavailable desc = no endpoint available from endpoint,context canceled","module":"request","name":"/helloworld.Greeter/SayHelloServerSideEvent","status":503,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/sse/world?msg=hello\u0026stream=message","x-request-id":"a6be9bfa-f5a9-437d-ac57-69f9b970625a","x-uid":""}
=== RUN   TestHttp/testClientStreamErr
{"elapsed":"693.051µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Canceled desc = context canceled","module":"request","name":"/helloworld.Greeter/SayHelloServerSideEvent","status":499,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/sse/world?msg=hello\u0026stream=message","x-request-id":"425e2b46-b0f6-4d65-9745-03d906068ff5","x-uid":""}

  test client stream error     http_test.go:885: test case:0
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":284,"message":"error type:*errors.errorString, error:test ClientSideStream error","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:896: data:
    http_test.go:885: test case:1
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":275,"message":"Failed to decode request:test NewDecoder error","status":400,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:896: data:{"message":"Unknown error", "code":5000}
    http_test.go:885: test case:2
[32m✔[0m{"elapsed":"17.103µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Unavailable desc = no endpoint available from endpoint,context canceled","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":503,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"f8734ffb-bd5b-436d-a72b-3fb4bd2f9757","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":275,"message":"Failed to add request params:test inParamsHandle error","status":400,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:896: data:{"message":"Unknown error", "code":5000}
    http_test.go:885: test case:3
[32m✔[0m{"elapsed":"23.627µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Unavailable desc = no endpoint available from endpoint,context canceled","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":503,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"ce3f5a6a-4483-4160-a75f-6a857906cb84","x-uid":""}
2024/05/20 01:24:45 /api/v1/example/client/stream,params:map[]
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":275,"message":"Failed to send request:test client stream send error","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:896: data:{"message":"Unknown error", "code":5000}
    http_test.go:885: test case:4
[32m✔[0m{"elapsed":"24.466µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Unavailable desc = no endpoint available from endpoint,context canceled","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":503,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"5387cc6a-1e34-4aab-bca4-40593a3597dd","x-uid":""}
2024/05/20 01:24:45 /api/v1/example/client/stream,params:map[]
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":284,"message":"error type:*fmt.wrapError, error:Failed to close send: test client stream close error","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:896: data:
    http_test.go:885: test case:5
[32m✔[0m2024/05/20 01:24:45 /api/v1/example/client/stream,params:map[]
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":284,"message":"error type:*fmt.wrapError, error:Failed to get header from client: test header error","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:896: data:
    http_test.go:885: test case:6
[32m✔[0m{"elapsed":"29.512µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Unavailable desc = no endpoint available from endpoint,test get conn error","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":503,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"7c983ee3-512e-4ea3-aa84-972058c41031","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":284,"message":"error type:*errors.errorString, error:test get conn error","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:896: data:
    http_test.go:885: test case:7
[32m✔[0m{"elapsed":"696.748µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"test new stream error","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":500,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"a0a916df-8e0d-41ee-bfd2-2aa23f44539d","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":284,"message":"error type:*errors.errorString, error:test new stream error","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:896: data:
    http_test.go:885: test case:8
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":275,"message":"Failed to decode request:failed to unmarshal message from HttpProtobufStreamImpl: test unmarshal error","status":400,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:896: data:{"message":"Unknown error", "code":5000}


[31m[0m[33m[0m[32m
323 total assertions[0m

=== RUN   TestHttp/testRequestError
{"elapsed":"15.61µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Unavailable desc = no endpoint available from endpoint,context canceled","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":503,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"067e12f5-0570-4365-8708-7c5989625849","x-uid":""}

  test request error     http_test.go:599: test error test case:0
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":275,"message":"decode request body err test json decode error","status":400,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:599: test error test case:1
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":275,"message":"Failed to add request params: test inParamsHandle error","status":400,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:599: test error test case:2
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":284,"message":"error type:*fmt.wrapError, error:Failed to add sha256 hash: test io copy error","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:599: test error test case:3
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":284,"message":"error type:*errors.errorString, error:test AnnotateContext error","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:599: test error test case:4
[32m✔[0m2024/05/20 01:24:45 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
{"elapsed":"13.685µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Internal desc = stream not exists in context","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":500,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"3532cc81-0877-4192-a77f-114eb03829d2","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":275,"message":"stream not exists in context","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:599: test error test case:5
[32m✔[0m2024/05/20 01:24:45 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
{"elapsed":"9.496µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Unavailable desc = no source ip","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":503,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"9443d141-e01f-493f-ad31-222f4a021569","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":275,"message":"no source ip","status":503,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:599: test error test case:6
[32m✔[0m2024/05/20 01:24:45 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
{"elapsed":"17.292µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"01c59dbe-2b61-4af4-8bd2-bc549757dd7d","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":284,"message":"error type:*errors.errorString, error:EOF","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:599: test error test case:7
[32m✔[0m2024/05/20 01:24:45 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
{"elapsed":"18.239µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Unavailable desc = no endpoint available to select,test select error","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":503,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"d7fe9e44-0e0a-4b1d-b4e3-73603b18306a","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":275,"message":"no endpoint available to select,test select error","status":503,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m    http_test.go:599: test error test case:8
[32m✔[0m2024/05/20 01:24:45 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
{"elapsed":"698.733µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Internal desc = failed proxying s2c: test forwardServerToClient error","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":500,"timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"e42bd19c-c736-4c53-99fb-fc615613febd","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":275,"message":"failed proxying s2c: test forwardServerToClient error","status":500,"timestamp":"2024-05-20 01:24:45"}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
350 total assertions[0m

=== RUN   TestHttp/testLoadHttpEndpointItemErr

  test load http endpoint item [32m✔[0m[32m✔[0m    http_test.go:940: err test case:0
[32m✔[0m    http_test.go:940: err test case:1
[32m✔[0m    http_test.go:940: err test case:2
[32m✔[0m

[31m[0m[33m[0m[32m
355 total assertions[0m

=== RUN   TestHttp/testDeleteEndpoint

  test delete endpoint [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"WARNING","line":371,"message":"not found router","timestamp":"2024-05-20 01:24:45","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"90fa79f3-10ce-40d5-a21a-c13f8b065c63","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
364 total assertions[0m

=== RUN   TestHttp/testRegisterLocalService

  test register local service [32m✔[0m[32m✔[0m[32m✔[0m2024/05/20 01:24:46 Start on 127.0.0.1:5376
[32m✔[0m2024/05/20 01:24:48 /api/v1/example/world?msg=hello,params:map[msg:[hello] name:[world]]
{"elapsed":"30.953µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-05-20 01:24:48","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"5852e788-2b51-4804-a07e-2a946f102faf","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
374 total assertions[0m


  test del local service [32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"WARNING","line":371,"message":"not found router","timestamp":"2024-05-20 01:24:48","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"dccd6ce8-2412-4f66-a699-d07e0d9947a1","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
377 total assertions[0m

--- PASS: TestHttp (12.16s)
    --- PASS: TestHttp/testRegisterClient (6.01s)
    --- PASS: TestHttp/testRequestGet (0.01s)
    --- PASS: TestHttp/testCors (0.00s)
    --- PASS: TestHttp/testRequestPost (0.01s)
    --- PASS: TestHttp/testServerSideEvent (0.00s)
    --- PASS: TestHttp/testWebsocket (0.00s)
    --- PASS: TestHttp/testClientStreamRequest (0.00s)
    --- PASS: TestHttp/testClientStreamRequestByMarshal (0.00s)
    --- PASS: TestHttp/testLoadGlobalTypes (0.03s)
    --- PASS: TestHttp/testUpdateLoadbalance (3.04s)
    --- PASS: TestHttp/testHttpError (0.01s)
    --- PASS: TestHttp/testWebSocketError (0.00s)
    --- PASS: TestHttp/testServerSideEventErr (0.00s)
    --- PASS: TestHttp/testClientStreamErr (0.00s)
    --- PASS: TestHttp/testRequestError (0.01s)
    --- PASS: TestHttp/testLoadHttpEndpointItemErr (0.01s)
    --- PASS: TestHttp/testDeleteEndpoint (0.01s)
    --- PASS: TestHttp/testRegisterLocalService (3.01s)
=== RUN   TestMask

  TestMask [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
386 total assertions[0m

--- PASS: TestMask (0.00s)
=== RUN   TestDecodeErr

  TestDecodeErr [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
390 total assertions[0m

--- PASS: TestDecodeErr (0.00s)
=== RUN   TestProtobufDescriptionErr
=== RUN   TestProtobufDescriptionErr/Test_initDescriptorSet_error

  Test initDescriptorSet error [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
393 total assertions[0m

=== RUN   TestProtobufDescriptionErr/Test_SetHttpResponse_error

  Test SetHttpResponse error [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
399 total assertions[0m

=== RUN   TestProtobufDescriptionErr/Test_NewDescription_error

  Test NewDescription error [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
409 total assertions[0m

=== RUN   TestProtobufDescriptionErr/Test_NewDescriptionFromBinary_error

  Test NewDescriptionFromBinary error [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
424 total assertions[0m

--- PASS: TestProtobufDescriptionErr (0.09s)
    --- PASS: TestProtobufDescriptionErr/Test_initDescriptorSet_error (0.01s)
    --- PASS: TestProtobufDescriptionErr/Test_SetHttpResponse_error (0.02s)
    --- PASS: TestProtobufDescriptionErr/Test_NewDescription_error (0.05s)
    --- PASS: TestProtobufDescriptionErr/Test_NewDescriptionFromBinary_error (0.01s)
=== RUN   TestRawBinaryUnmarshaler

  TestRawBinaryUnmarshaler [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
432 total assertions[0m

--- PASS: TestRawBinaryUnmarshaler (0.00s)
=== RUN   TestRawBinaryDecodeErr

  TestRawBinaryDecodeErr [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
438 total assertions[0m

--- PASS: TestRawBinaryDecodeErr (0.00s)
=== RUN   TestBuildGrpcRequest

  TestBuildGrpcRequest [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
447 total assertions[0m

--- PASS: TestBuildGrpcRequest (0.00s)
=== RUN   TestNewEndpoint

  TestNewEndpoint [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
455 total assertions[0m

--- PASS: TestNewEndpoint (0.00s)
=== RUN   TestJSONCamelCase

  TestJSONCamelCase [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
459 total assertions[0m

--- PASS: TestJSONCamelCase (0.00s)
PASS
	github.com/begonia-org/begonia/gateway	coverage: 92.8% of statements
ok  	github.com/begonia-org/begonia/gateway	15.329s	coverage: 92.8% of statements
=== RUN   TestAKSK
=== RUN   TestAKSK/get_secret

  get secret [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
2 total assertions[0m


  get secret fail {"file":"/data/work/begonia-org/go-layered-cache/kv.go","fn":"Get","level":"ERROR","line":102,"message":"local.Get begonia:kv:app:access_key:ddddeeeeeedede error:Entry not found","timestamp":"2024-05-20 01:24:34"}
[32m✔[0m

[31m[0m[33m[0m[32m
3 total assertions[0m

=== RUN   TestAKSK/get_appid

  get appid [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
5 total assertions[0m


  get appid fail {"file":"/data/work/begonia-org/go-layered-cache/kv.go","fn":"Get","level":"ERROR","line":102,"message":"local.Get begonia:kv:app:appid:dddddeeedwecccwcqdq error:Entry not found","timestamp":"2024-05-20 01:24:34"}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
7 total assertions[0m

=== RUN   TestAKSK/validator

  test validator success [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
11 total assertions[0m


  test validator fail with missing key params [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
23 total assertions[0m

--- PASS: TestAKSK (0.93s)
    --- PASS: TestAKSK/get_secret (0.93s)
    --- PASS: TestAKSK/get_appid (0.00s)
    --- PASS: TestAKSK/validator (0.00s)
=== RUN   TestAppBiz
=== RUN   TestAppBiz/testPutApp

  test app put success [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
26 total assertions[0m


  test app put failed [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
33 total assertions[0m

=== RUN   TestAppBiz/testGetApp

  test app get success [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
39 total assertions[0m


  test app get failed [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
41 total assertions[0m

=== RUN   TestAppBiz/testPatchApp

  test app patch success [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
54 total assertions[0m


  test app patch failed [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
58 total assertions[0m

=== RUN   TestAppBiz/testListApp

  test app list success [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
61 total assertions[0m


  test app list failed [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
63 total assertions[0m

=== RUN   TestAppBiz/testDelApp

  test app del success [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
66 total assertions[0m

--- PASS: TestAppBiz (0.04s)
    --- PASS: TestAppBiz/testPutApp (0.02s)
    --- PASS: TestAppBiz/testGetApp (0.00s)
    --- PASS: TestAppBiz/testPatchApp (0.01s)
    --- PASS: TestAppBiz/testListApp (0.00s)
    --- PASS: TestAppBiz/testDelApp (0.01s)
=== RUN   TestAuthz
=== RUN   TestAuthz/test_auth_seed

  test auth seed [32m✔[0m

[31m[0m[33m[0m[32m
67 total assertions[0m

=== RUN   TestAuthz/test_login

  test login success [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
70 total assertions[0m


  test login failed with invalid password [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
74 total assertions[0m


  test login failed with invalid account [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
78 total assertions[0m


  test login failed with invalid pub key [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
81 total assertions[0m


  test login failed with invalid seed token expiration [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
85 total assertions[0m

=== RUN   TestAuthz/test_logout

  test logout success [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
88 total assertions[0m


  test logout fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
92 total assertions[0m

--- PASS: TestAuthz (0.38s)
    --- PASS: TestAuthz/test_auth_seed (0.00s)
    --- PASS: TestAuthz/test_login (0.37s)
    --- PASS: TestAuthz/test_logout (0.00s)
=== RUN   TestDo

  test data operator do success [32m✔[0m[32m✔[0m[32m✔[0m[33m✘[0m

[31m[0m[33m
Failures:

  * /data/work/begonia-org/begonia/internal/biz/data_test.go 
  Line 109:
  Expected: nil
  Actual:   'Entry not found'

[0m[33m
96 total assertions[0m

--- FAIL: TestDo (5.03s)
=== RUN   TestUser
=== RUN   TestUser/testPutUser

  test user put success [32m✔[0m{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"Do","level":"INFO","line":56,"message":"start watch","timestamp":"2024-05-20 01:24:40"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"loadUsersBlacklist","level":"INFO","line":101,"message":"lock key:3599","timestamp":"2024-05-20 01:24:40"}
2024/05/20 01:24:40 lock key: begonia:user:black:lock,ttl:3599000000000
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"Do","level":"INFO","line":56,"message":"start watch","timestamp":"2024-05-20 01:24:40"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"loadUsersBlacklist","level":"INFO","line":101,"message":"lock key:3599","timestamp":"2024-05-20 01:24:40"}
2024/05/20 01:24:40 lock key: begonia:user:black:lock,ttl:3599000000000
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":120,"message":"unlock success","timestamp":"2024-05-20 01:24:40"}
[32m✔[0m

[31m[0m[33m[0m[33m
98 total assertions[0m


  test user put failed [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[33m
100 total assertions[0m

=== RUN   TestUser/testGetUser

  test user get success [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[33m
102 total assertions[0m


  test user get failed [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[33m
104 total assertions[0m

=== RUN   TestUser/testPatchUser

  test user patch success [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[33m
106 total assertions[0m


  test user patch failed [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[33m
111 total assertions[0m

=== RUN   TestUser/testListUser

  test user list success [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[33m
113 total assertions[0m


  test user list failed [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[33m
115 total assertions[0m

=== RUN   TestUser/testDeleteUser

  test user delete success [32m✔[0m

[31m[0m[33m[0m[33m
116 total assertions[0m


  test user delete failed [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[33m
118 total assertions[0m

--- PASS: TestUser (2.15s)
    --- PASS: TestUser/testPutUser (2.03s)
    --- PASS: TestUser/testGetUser (0.00s)
    --- PASS: TestUser/testPatchUser (0.01s)
    --- PASS: TestUser/testListUser (0.10s)
    --- PASS: TestUser/testDeleteUser (0.01s)
FAIL
	github.com/begonia-org/begonia/internal/biz	coverage: 82.6% of statements
FAIL	github.com/begonia-org/begonia/internal/biz	9.109s
=== RUN   TestEndpoint
=== RUN   TestEndpoint/Test_Add_Endpoint

  Test Add Endpoint [32m✔[0m2024/05/20 01:24:33 endpoint add tags :[test-biz=0]
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
3 total assertions[0m


  Test Add Endpoint Fail [32m✔[0m[32m✔[0m2024/05/20 01:24:33 endpoint add tags :[test-biz=0]
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
7 total assertions[0m

=== RUN   TestEndpoint/Test_Watcher_Update

  Test Watcher Update [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
9 total assertions[0m


  test watcher update fail [32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/internal/biz/endpoint/watcher.go","fn":"Update","level":"ERROR","line":41,"message":"get descriptor set error: rpc error: code = Internal desc = Failed to register: no gateway content","timestamp":"2024-05-20 01:24:33"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
16 total assertions[0m

=== RUN   TestEndpoint/Test_Get_Endpoint

  Test Get Endpoint Fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
21 total assertions[0m


  Test Get Endpoint [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
23 total assertions[0m

=== RUN   TestEndpoint/Test_Patch_Endpoint

  Test Patch Endpoint [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
30 total assertions[0m


  Test Patch Endpoint Fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
38 total assertions[0m

=== RUN   TestEndpoint/Test_List_Endpoint

  Test List Endpoint 2024/05/20 01:24:33 endpoint add tags :[test-biz-1-20240520012433 test-biz-3-20240520012433]
[32m✔[0m[32m✔[0m2024/05/20 01:24:33 endpoint add tags :[test-biz-1-20240520012433 test-biz-2-20240520012433]
[32m✔[0m[32m✔[0m2024/05/20 01:24:33 endpoint add tags :[test-biz-1-20240520012433 test-biz-3-20240520012433]
[32m✔[0m[32m✔[0m2024/05/20 01:24:33 endpoint add tags :[test-biz-0-20240520012433 test-biz-3-20240520012433]
[32m✔[0m[32m✔[0m2024/05/20 01:24:33 endpoint add tags :[test-biz-0-20240520012433 test-biz-2-20240520012433]
[32m✔[0m[32m✔[0m2024/05/20 01:24:33 endpoint add tags :[test-biz-1-20240520012433 test-biz-3-20240520012433]
[32m✔[0m[32m✔[0m2024/05/20 01:24:33 endpoint add tags :[test-biz-0-20240520012433 test-biz-3-20240520012433]
[32m✔[0m[32m✔[0m2024/05/20 01:24:33 endpoint add tags :[test-biz-1-20240520012433 test-biz-3-20240520012433]
[32m✔[0m[32m✔[0m2024/05/20 01:24:33 endpoint add tags :[test-biz-1-20240520012433 test-biz-3-20240520012433]
[32m✔[0m[32m✔[0m2024/05/20 01:24:33 endpoint add tags :[test-biz-0-20240520012433 test-biz-3-20240520012433]
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
64 total assertions[0m

=== RUN   TestEndpoint/Test_Watcher_Update#01

  Test Watcher Update [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
66 total assertions[0m


  test watcher update fail [32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/internal/biz/endpoint/watcher.go","fn":"Update","level":"ERROR","line":41,"message":"get descriptor set error: rpc error: code = Internal desc = Failed to register: no gateway content","timestamp":"2024-05-20 01:24:33"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
73 total assertions[0m

=== RUN   TestEndpoint/Test_Watcher_Del

  Test Watcher Del [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
75 total assertions[0m


  test watcher del fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
80 total assertions[0m

=== RUN   TestEndpoint/Test_Del_Endpoint

  Test Del Endpoint [32m✔[0m

[31m[0m[33m[0m[32m
81 total assertions[0m

--- PASS: TestEndpoint (0.15s)
    --- PASS: TestEndpoint/Test_Add_Endpoint (0.02s)
    --- PASS: TestEndpoint/Test_Watcher_Update (0.04s)
    --- PASS: TestEndpoint/Test_Get_Endpoint (0.00s)
    --- PASS: TestEndpoint/Test_Patch_Endpoint (0.00s)
    --- PASS: TestEndpoint/Test_List_Endpoint (0.03s)
    --- PASS: TestEndpoint/Test_Watcher_Update#01 (0.03s)
    --- PASS: TestEndpoint/Test_Watcher_Del (0.02s)
    --- PASS: TestEndpoint/Test_Del_Endpoint (0.00s)
PASS
	github.com/begonia-org/begonia/internal/biz/endpoint	coverage: 95.2% of statements
ok  	github.com/begonia-org/begonia/internal/biz/endpoint	0.297s	coverage: 95.2% of statements
=== RUN   TestFile
=== RUN   TestFile/test_upload

  test upload without version 2024/05/20 01:24:33 uploadRootDir:/tmp/upload,filePath:/tmp/upload/tester-20240520012433/test/upload.test1
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
5 total assertions[0m


  test upload with version 2024/05/20 01:24:33 uploadRootDir:/tmp/upload,filePath:/tmp/upload/tester-20240520012433/test/upload.test2
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
11 total assertions[0m


  test upload with version1 2024/05/20 01:24:33 uploadRootDir:/tmp/upload,filePath:/tmp/upload/tester-20240520012433/test/upload.test2
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
17 total assertions[0m


  test upload with version2 2024/05/20 01:24:33 uploadRootDir:/tmp/upload,filePath:/tmp/upload/tester-20240520012433/test/upload.test2
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
23 total assertions[0m


  test upload with version3 2024/05/20 01:24:34 uploadRootDir:/tmp/upload,filePath:/tmp/upload/tester-20240520012433/test/upload.test2
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
29 total assertions[0m


  test upload with invalid key [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
31 total assertions[0m


  test upload with invalid author [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
33 total assertions[0m


  test upload fail with not match sha256 2024/05/20 01:24:34 uploadRootDir:/tmp/upload,filePath:/tmp/upload/tester-20240520012433/test/upload.test7
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
35 total assertions[0m


  test upload fail     file_test.go:284: version:0225a7360b7a2a5951d08c6c84d2d6d694209f36,sha256:23a8426f19b1f7088273bfc39ccbfaf19dd7d235cc72d1ca29a5fa951b9a29bb
    file_test.go:284: version:909761bd0455c485b8f61aa51b2696e85d141de8,sha256:27e113c48f382c6258a2cbbc7cf10fa9ba9816cfdb30395371a386e9b7a30c38
    file_test.go:284: version:7add256af7f46ffa964c4c82a7d9d2f705130e66,sha256:27e113c48f382c6258a2cbbc7cf10fa9ba9816cfdb30395371a386e9b7a30c38
    file_test.go:284: version:80a44c71f1c16ab05015326fd6dea46f43394121,sha256:27e113c48f382c6258a2cbbc7cf10fa9ba9816cfdb30395371a386e9b7a30c38
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
44 total assertions[0m

=== RUN   TestFile/test_download

  download success [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
47 total assertions[0m


  download with version1 [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
50 total assertions[0m


  download with version2 [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
53 total assertions[0m


  download with version3 [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
56 total assertions[0m


  download with latest version [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
59 total assertions[0m


  download fail with invalidate key [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
61 total assertions[0m


  download fail with version and invalidate key [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
63 total assertions[0m

=== RUN   TestFile/test_initiate_upload_file

  test init parts upload file success [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
67 total assertions[0m


  test init parts upload file fail [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
69 total assertions[0m

=== RUN   TestFile/test_upload_parts_file

  test upload parts file success 
  upload 447449501137899520 for 1 part 2024/05/20 01:24:34 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449501137899520/parts/00000001.part
[32m✔[0m

[31m[0m[33m[0m[32m
70 total assertions[0m


  upload 447449501137899520 for 2 part 2024/05/20 01:24:34 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449501137899520/parts/00000002.part
[32m✔[0m

[31m[0m[33m[0m[32m
71 total assertions[0m


  upload 447449501137899520 for 3 part 
  upload 447449501137899520 for 4 part 
  upload 447449501137899520 for 5 part 2024/05/20 01:24:34 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449501137899520/parts/00000004.part
[32m✔[0m

[31m[0m[33m[0m[32m
72 total assertions[0m

2024/05/20 01:24:34 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449501137899520/parts/00000003.part
[32m✔[0m

[31m[0m[33m[0m[32m
73 total assertions[0m

2024/05/20 01:24:34 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449501137899520/parts/00000005.part
[32m✔[0m

[31m[0m[33m[0m[32m
74 total assertions[0m


  upload 447449501137899520 for 6 part 2024/05/20 01:24:34 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449501137899520/parts/00000006.part
[32m✔[0m

[31m[0m[33m[0m[32m
75 total assertions[0m

[32m✔[0m

[31m[0m[33m[0m[32m
76 total assertions[0m


  test upload parts file fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
85 total assertions[0m

=== RUN   TestFile/test_complete_parts_file

  test complete parts file success 2024/05/20 01:24:34 uploadRootDir:/tmp/upload,filePath:/tmp/upload/tester-20240520012433/test/upload.parts.test1
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
89 total assertions[0m


  test complete parts file fail [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
91 total assertions[0m

=== RUN   TestFile/test_file_metadata

  test file metadata [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
95 total assertions[0m


  test file metadata fail [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
97 total assertions[0m

=== RUN   TestFile/test_version_reader

  test version reader [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
104 total assertions[0m

=== RUN   TestFile/test_abort_parts_file

  test abort parts file success [32m✔[0m[32m✔[0m
  upload 447449506456276992 for 1 part 
  upload 447449506456276992 for 2 part 
  upload 447449506456276992 for 3 part 2024/05/20 01:24:35 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449506456276992/parts/00000002.part
[32m✔[0m

[31m[0m[33m[0m[32m
107 total assertions[0m

2024/05/20 01:24:35 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449506456276992/parts/00000001.part
[32m✔[0m

[31m[0m[33m[0m[32m
108 total assertions[0m


  upload 447449506456276992 for 4 part 2024/05/20 01:24:35 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449506456276992/parts/00000004.part
[32m✔[0m

[31m[0m[33m[0m[32m
109 total assertions[0m


  upload 447449506456276992 for 5 part 2024/05/20 01:24:35 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449506456276992/parts/00000003.part
[32m✔[0m

[31m[0m[33m[0m[32m
110 total assertions[0m


  upload 447449506456276992 for 6 part 2024/05/20 01:24:35 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449506456276992/parts/00000005.part
[32m✔[0m

[31m[0m[33m[0m[32m
111 total assertions[0m

2024/05/20 01:24:35 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449506456276992/parts/00000006.part
[32m✔[0m

[31m[0m[33m[0m[32m
112 total assertions[0m

[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
116 total assertions[0m


  test abort parts file fail [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
118 total assertions[0m

=== RUN   TestFile/test_download_range_parts_file

  test download range parts file success [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
125 total assertions[0m


  test download range parts file fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
129 total assertions[0m

=== RUN   TestFile/test_delete_file

  test delete file success [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
133 total assertions[0m


  test delete file fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
137 total assertions[0m

--- PASS: TestFile (3.44s)
    --- PASS: TestFile/test_upload (0.26s)
    --- PASS: TestFile/test_download (0.21s)
    --- PASS: TestFile/test_initiate_upload_file (0.00s)
    --- PASS: TestFile/test_upload_parts_file (0.19s)
    --- PASS: TestFile/test_complete_parts_file (0.58s)
    --- PASS: TestFile/test_file_metadata (0.23s)
    --- PASS: TestFile/test_version_reader (0.27s)
    --- PASS: TestFile/test_abort_parts_file (0.12s)
    --- PASS: TestFile/test_download_range_parts_file (1.46s)
    --- PASS: TestFile/test_delete_file (0.12s)
PASS
	github.com/begonia-org/begonia/internal/biz/file	coverage: 81.5% of statements
ok  	github.com/begonia-org/begonia/internal/biz/file	3.549s	coverage: 81.5% of statements
=== RUN   TestApp
=== RUN   TestApp/add_app

  test app add success     app_test.go:44: add test
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
7 total assertions[0m

=== RUN   TestApp/get_app

  test app get success     app_test.go:89: get test
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
12 total assertions[0m

=== RUN   TestApp/add_duplicate_name

  test app add duplicate name     app_test.go:109: add test
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
14 total assertions[0m

=== RUN   TestApp/patch_app

  test app patch success     app_test.go:138: patch test
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
21 total assertions[0m

=== RUN   TestApp/list_app

  test app list [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
42 total assertions[0m

=== RUN   TestApp/del_app

  test app delete success     app_test.go:232: delete test
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
44 total assertions[0m

--- PASS: TestApp (1.11s)
    --- PASS: TestApp/add_app (1.01s)
    --- PASS: TestApp/get_app (0.00s)
    --- PASS: TestApp/add_duplicate_name (0.00s)
    --- PASS: TestApp/patch_app (0.01s)
    --- PASS: TestApp/list_app (0.07s)
    --- PASS: TestApp/del_app (0.01s)
=== RUN   TestAuthzRepo
=== RUN   TestAuthzRepo/testCacheToken

  test cache token [32m✔[0m

[31m[0m[33m[0m[32m
45 total assertions[0m

=== RUN   TestAuthzRepo/testGetToken

  test get token [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
47 total assertions[0m


  test token expiration [32m✔[0m

[31m[0m[33m[0m[32m
48 total assertions[0m

=== RUN   TestAuthzRepo/deleteToken

  test delete exp token [32m✔[0m

[31m[0m[33m[0m[32m
49 total assertions[0m


  test token delete [32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/go-layered-cache/kv.go","fn":"Get","level":"ERROR","line":102,"message":"local.Get test:token2 error:Entry not found","timestamp":"2024-05-20 01:24:42"}
[32m✔[0m

[31m[0m[33m[0m[32m
52 total assertions[0m

=== RUN   TestAuthzRepo/testPutBlacklist

  test put blacklist [32m✔[0m

[31m[0m[33m[0m[32m
53 total assertions[0m

=== RUN   TestAuthzRepo/testCheckInBlackList

  test check in blacklist [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
57 total assertions[0m

--- PASS: TestAuthzRepo (7.01s)
    --- PASS: TestAuthzRepo/testCacheToken (0.00s)
    --- PASS: TestAuthzRepo/testGetToken (7.00s)
    --- PASS: TestAuthzRepo/deleteToken (0.00s)
    --- PASS: TestAuthzRepo/testPutBlacklist (0.00s)
    --- PASS: TestAuthzRepo/testCheckInBlackList (0.00s)
=== RUN   TestEndpoint
=== RUN   TestEndpoint/put

  test app add success     endpoint_test.go:30: add test
[32m✔[0m

[31m[0m[33m[0m[32m
58 total assertions[0m

=== RUN   TestEndpoint/get

  test endpoint get success [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
62 total assertions[0m

=== RUN   TestEndpoint/getKeysByTags

  test get keys by tags success [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
65 total assertions[0m

=== RUN   TestEndpoint/list

  test list [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
81 total assertions[0m

=== RUN   TestEndpoint/patch

  test endpoint patch success [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m    endpoint_test.go:199: keys:[/begonia/endpoints/service/447449535103373312]
[32m✔[0m

[31m[0m[33m[0m[32m
94 total assertions[0m

=== RUN   TestEndpoint/putTags

  test endpoint add tags [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
106 total assertions[0m

=== RUN   TestEndpoint/del

  test endpoint delete [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
111 total assertions[0m

--- PASS: TestEndpoint (1.30s)
    --- PASS: TestEndpoint/put (0.01s)
    --- PASS: TestEndpoint/get (0.00s)
    --- PASS: TestEndpoint/getKeysByTags (0.00s)
    --- PASS: TestEndpoint/list (1.24s)
    --- PASS: TestEndpoint/patch (0.01s)
    --- PASS: TestEndpoint/putTags (0.00s)
    --- PASS: TestEndpoint/del (0.03s)
=== RUN   TestOperator
=== RUN   TestOperator/testGetAllForbiddenUsers

  test get all forbidden users [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
114 total assertions[0m

=== RUN   TestOperator/testFlashUsersCache

  test flash users cache {"file":"/data/work/begonia-org/begonia/internal/data/operator.go","fn":"func1","level":"INFO","line":208,"message":"data operator repo start","timestamp":"2024-05-20 01:24:43"}
[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
117 total assertions[0m

=== RUN   TestOperator/testGetAllApp

  test get all app [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
129 total assertions[0m

=== RUN   TestOperator/testFlashAppsCache

  test flash apps cache [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
131 total assertions[0m

=== RUN   TestOperator/testLastUpdated

  test last updated [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
133 total assertions[0m

=== RUN   TestOperator/testWatcher

  test watcher [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
137 total assertions[0m

--- PASS: TestOperator (6.47s)
    --- PASS: TestOperator/testGetAllForbiddenUsers (0.29s)
    --- PASS: TestOperator/testFlashUsersCache (1.06s)
    --- PASS: TestOperator/testGetAllApp (0.08s)
    --- PASS: TestOperator/testFlashAppsCache (0.03s)
    --- PASS: TestOperator/testLastUpdated (0.00s)
    --- PASS: TestOperator/testWatcher (5.01s)
=== RUN   TestUser
=== RUN   TestUser/testAddUser

  test user add success     user_test.go:30: add test
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
141 total assertions[0m

=== RUN   TestUser/testGetUser

  test user get success     user_test.go:89: get test
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m
    test user get by account     user_test.go:106: account: 87ae8aae2a9b5c1f567d7a0c17403194a8c5b5b5
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
150 total assertions[0m

=== RUN   TestUser/testUpdateUser

  test user update success     user_test.go:119: update test
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
162 total assertions[0m

=== RUN   TestUser/testDelUser

  test user delete success     user_test.go:161: delete test
[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
165 total assertions[0m

=== RUN   TestUser/testListUser

  test user list success [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
173 total assertions[0m

--- PASS: TestUser (9.79s)
    --- PASS: TestUser/testAddUser (2.18s)
    --- PASS: TestUser/testGetUser (0.00s)
    --- PASS: TestUser/testUpdateUser (1.34s)
    --- PASS: TestUser/testDelUser (0.25s)
    --- PASS: TestUser/testListUser (6.02s)
PASS
	github.com/begonia-org/begonia/internal/data	coverage: 67.2% of statements
ok  	github.com/begonia-org/begonia/internal/data	25.852s	coverage: 67.2% of statements
2024/05/20 01:24:35 run test server
{"file":"/data/work/begonia-org/begonia/internal/pkg/middleware/middleware.go","fn":"New","level":"INFO","line":48,"message":"plugin exception priority 0","timestamp":"2024-05-20 01:24:36"}
{"file":"/data/work/begonia-org/begonia/internal/pkg/middleware/middleware.go","fn":"New","level":"INFO","line":48,"message":"plugin http priority 2","timestamp":"2024-05-20 01:24:36"}
{"file":"/data/work/begonia-org/begonia/internal/pkg/middleware/middleware.go","fn":"New","level":"INFO","line":48,"message":"plugin params_validator priority 3","timestamp":"2024-05-20 01:24:36"}
{"file":"/data/work/begonia-org/begonia/internal/pkg/middleware/middleware.go","fn":"New","level":"INFO","line":48,"message":"plugin auth priority 4","timestamp":"2024-05-20 01:24:36"}
{"file":"/data/work/begonia-org/begonia/internal/pkg/middleware/middleware.go","fn":"New","level":"INFO","line":48,"message":"plugin logger priority 1","timestamp":"2024-05-20 01:24:36"}
2024/05/20 01:24:39 Start on 0.0.0.0:12140
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"Do","level":"INFO","line":56,"message":"start watch","timestamp":"2024-05-20 01:24:41"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"loadUsersBlacklist","level":"INFO","line":101,"message":"lock key:3599","timestamp":"2024-05-20 01:24:41"}
2024/05/20 01:24:41 lock key: begonia:user:black:lock,ttl:3599000000000
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":120,"message":"unlock success","timestamp":"2024-05-20 01:24:41"}
=== RUN   TestApp
=== RUN   TestApp/add_app

  test add app 2024/05/20 01:24:42 /api/v1/app,params:map[]
{"elapsed":"18.914223ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AppsService/Put","status":200,"timestamp":"2024-05-20 01:24:42","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/app","x-request-id":"fb7e6fe2-7994-4f46-88c5-acb176c14ad9","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
3 total assertions[0m

=== RUN   TestApp/get_app

  test get app 2024/05/20 01:24:42 /api/v1/app/447449537208913920,params:map[appid:[447449537208913920]]
{"elapsed":"527.928µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AppsService/Get","status":200,"timestamp":"2024-05-20 01:24:42","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/app/447449537208913920","x-request-id":"9ac626e5-422f-4079-9152-e5f3f988306e","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
5 total assertions[0m

=== RUN   TestApp/del_app

  test del app 2024/05/20 01:24:42 /api/v1/app/447449537208913920,params:map[appid:[447449537208913920]]
{"elapsed":"146.094531ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AppsService/Delete","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"DELETE","x-http-uri":"/api/v1/app/447449537208913920","x-request-id":"09f55a09-39f3-4094-bff4-eff2cde23081","x-uid":""}
[32m✔[0m[32m✔[0m2024/05/20 01:24:43 /api/v1/app/447449537208913920,params:map[appid:[447449537208913920]]
{"file":"/data/work/begonia-org/begonia/internal/service/app.go","fn":"Get","level":"ERROR","line":33,"message":"GetApps failed: rpc error: code = NotFound desc = get app failed: get model failed: record not found","timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/app/447449537208913920","x-request-id":"bbe25243-342c-480c-9d9c-e563155de3b7","x-uid":""}
{"elapsed":"739.388µs","file":"/data/work/begonia-org/begonia/internal/biz/app.go","fn":"github.com/begonia-org/begonia/internal/biz.(*AppUsecase).Get","level":"ERROR","line":131,"message":"rpc error: code = NotFound desc = get app failed: get model failed: record not found","module":"request","name":"/begonia.org.sdk.AppsService/Get","status":5108,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/app/447449537208913920","x-request-id":"bbe25243-342c-480c-9d9c-e563155de3b7","x-uid":""}
{"file":"/data/work/begonia-org/begonia/internal/biz/app.go","fn":"github.com/begonia-org/begonia/internal/biz.(*AppUsecase).Get","level":"ERROR","line":131,"message":"get app failed: get model failed: record not found","status":404,"timestamp":"2024-05-20 01:24:43"}
[32m✔[0m

[31m[0m[33m[0m[32m
8 total assertions[0m

--- PASS: TestApp (0.18s)
    --- PASS: TestApp/add_app (0.02s)
    --- PASS: TestApp/get_app (0.00s)
    --- PASS: TestApp/del_app (0.15s)
=== RUN   TestAuth
=== RUN   TestAuth/login

  test login [32m✔[0m2024/05/20 01:24:43 /api/v1/auth/log/1716139483056000,params:map[token:[1716139483056000]]
{"elapsed":"65.167µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AuthService/AuthSeed","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/auth/log/1716139483056000","x-request-id":"a89b0d4c-9fd9-4fce-a150-84268dde3c48","x-uid":""}
2024/05/20 01:24:43 /api/v1/auth/login,params:map[]
{"elapsed":"2.412727ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AuthService/Login","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/auth/login","x-request-id":"4839b297-23e0-40c1-92e4-9e0c7e9f0c74","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/05/20 01:24:43 /v1/gateway/info,params:map[]
{"file":"/data/work/begonia-org/go-layered-cache/cuckoo.go","fn":"Check","level":"ERROR","line":100,"message":"local.Get begonia:filter:user:black error:not found such bloom filter begonia:filter:user:black","timestamp":"2024-05-20 01:24:43"}
{"file":"/data/work/begonia-org/begonia/internal/data/cache.go","fn":"CheckInFilter","level":"ERROR","line":93,"message":"check value of begonia:filter:user:black error:not found such bloom filter begonia:filter:user:black","timestamp":"2024-05-20 01:24:43"}
{"elapsed":"1.864µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.SystemService/Get","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/v1/gateway/info","x-request-id":"5dcf1090-d8ef-4eee-adc8-39789769ae3b","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m    authz_test.go:85: test-20240507141004 20240520012430 7888e01


[31m[0m[33m[0m[32m
19 total assertions[0m

=== RUN   TestAuth/logout

  test logout 2024/05/20 01:24:43 /api/v1/auth/logout,params:map[]
{"file":"/data/work/begonia-org/go-layered-cache/cuckoo.go","fn":"Check","level":"ERROR","line":100,"message":"local.Get begonia:filter:user:black error:not found such bloom filter begonia:filter:user:black","timestamp":"2024-05-20 01:24:43"}
{"file":"/data/work/begonia-org/begonia/internal/data/cache.go","fn":"CheckInFilter","level":"ERROR","line":93,"message":"check value of begonia:filter:user:black error:not found such bloom filter begonia:filter:user:black","timestamp":"2024-05-20 01:24:43"}
{"elapsed":"1.120434ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AuthService/Logout","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"DELETE","x-http-uri":"/api/v1/auth/logout","x-request-id":"66cd7e0e-a9ba-4ec9-8ad6-fe5e3223f48f","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m2024/05/20 01:24:43 /v1/gateway/info,params:map[]
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":275,"message":"check token error,登陆状态校验: token在黑名单中","status":401,"timestamp":"2024-05-20 01:24:43"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
26 total assertions[0m

--- PASS: TestAuth (0.02s)
    --- PASS: TestAuth/login (0.01s)
    --- PASS: TestAuth/logout (0.00s)
=== RUN   TestFile
=== RUN   TestFile/upload

  test upload file 2024/05/20 01:24:43 /api/v1/file,params:map[]
2024/05/20 01:24:43 uploadRootDir:/tmp/upload,filePath:/tmp/upload/443445555834654720/test/helloworld.pb
{"elapsed":"80.54782ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/Upload","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/file","x-request-id":"18107d23-a30f-4229-8095-540402a8ed15","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
33 total assertions[0m

=== RUN   TestFile/download

  test download file [32m✔[0m2024/05/20 01:24:43 /api/v1/file?key=443445555834654720%2Ftest%2Fhelloworld.pb,params:map[key:[443445555834654720/test/helloworld.pb]]
{"elapsed":"66.88µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/Download","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/file?key=443445555834654720%2Ftest%2Fhelloworld.pb","x-request-id":"e3581ecd-99fc-4ad6-a8af-efaee50d4dae","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m    file_test.go:182: 8b8812a5661179bef9ef057ec3c448cf244f9ddf6bd669bfd681e5696ae616be
[32m✔[0m

[31m[0m[33m[0m[32m
38 total assertions[0m

=== RUN   TestFile/uploadParts

  test upload file [32m✔[0m2024/05/20 01:24:43 /api/v1/file/part/init,params:map[]
{"elapsed":"193.002µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/InitiateMultipartUpload","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/file/part/init","x-request-id":"91333ffe-9a51-43dc-806c-cd5e867b193a","x-uid":""}
2024/05/20 01:24:43 /api/v1/file/part,params:map[]
2024/05/20 01:24:43 /api/v1/file/part,params:map[]
2024/05/20 01:24:43 /api/v1/file/part,params:map[]
2024/05/20 01:24:43 /api/v1/file/part,params:map[]
2024/05/20 01:24:43 /api/v1/file/part,params:map[]
2024/05/20 01:24:43 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449538823720960/parts/00000001.part
{"elapsed":"10.024899ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/UploadMultipartFile","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"PUT","x-http-uri":"/api/v1/file/part","x-request-id":"4f3b2d45-290c-4a41-8a25-fd01f3e3eec5","x-uid":""}
2024/05/20 01:24:43 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449538823720960/parts/00000002.part
{"elapsed":"9.671763ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/UploadMultipartFile","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"PUT","x-http-uri":"/api/v1/file/part","x-request-id":"c7d2f908-b778-4b87-a34f-b23d84d306c1","x-uid":""}
2024/05/20 01:24:43 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449538823720960/parts/00000003.part
{"elapsed":"9.671434ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/UploadMultipartFile","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"PUT","x-http-uri":"/api/v1/file/part","x-request-id":"34ebc20a-00dd-4b4b-ace8-d257aaa52b3b","x-uid":""}
2024/05/20 01:24:43 /api/v1/file/part,params:map[]
2024/05/20 01:24:43 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449538823720960/parts/00000005.part
{"elapsed":"6.439406ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/UploadMultipartFile","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"PUT","x-http-uri":"/api/v1/file/part","x-request-id":"6843b0c9-9104-417e-a5ee-99905fa8f6ef","x-uid":""}
2024/05/20 01:24:43 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449538823720960/parts/00000004.part
{"elapsed":"9.784541ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/UploadMultipartFile","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"PUT","x-http-uri":"/api/v1/file/part","x-request-id":"09fb07b8-052c-4129-86eb-ee145429e6f4","x-uid":""}
2024/05/20 01:24:43 /api/v1/file/part,params:map[]
2024/05/20 01:24:43 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449538823720960/parts/00000006.part
{"elapsed":"6.01377ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/UploadMultipartFile","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"PUT","x-http-uri":"/api/v1/file/part","x-request-id":"9ba506ee-feac-471f-8729-206857de9548","x-uid":""}
2024/05/20 01:24:43 /api/v1/file/part,params:map[]
2024/05/20 01:24:43 /api/v1/file/part,params:map[]
2024/05/20 01:24:43 /api/v1/file/part,params:map[]
2024/05/20 01:24:43 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449538823720960/parts/00000007.part
{"elapsed":"8.34296ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/UploadMultipartFile","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"PUT","x-http-uri":"/api/v1/file/part","x-request-id":"9a4f977a-1d84-4e77-a041-ffb215b9c145","x-uid":""}
2024/05/20 01:24:43 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449538823720960/parts/00000009.part
{"elapsed":"6.126361ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/UploadMultipartFile","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"PUT","x-http-uri":"/api/v1/file/part","x-request-id":"9a90061f-0cf5-430a-8fe5-457a25e5afce","x-uid":""}
2024/05/20 01:24:43 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449538823720960/parts/00000008.part
{"elapsed":"5.932327ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/UploadMultipartFile","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"PUT","x-http-uri":"/api/v1/file/part","x-request-id":"b10129e4-9307-42de-988d-4da197fdcf17","x-uid":""}
2024/05/20 01:24:43 uploadRootDir:/tmp/upload,filePath:/tmp/upload/447449538823720960/parts/00000010.part
{"elapsed":"5.976091ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/UploadMultipartFile","status":200,"timestamp":"2024-05-20 01:24:43","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"PUT","x-http-uri":"/api/v1/file/part","x-request-id":"f3338ed6-7f30-4283-97e7-af04b1909493","x-uid":""}
2024/05/20 01:24:43 /api/v1/file/part/complete,params:map[]
2024/05/20 01:24:43 uploadRootDir:/tmp/upload,filePath:/tmp/upload/443445555834654720/test/tmp.bin
{"elapsed":"722.303731ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/CompleteMultipartUpload","status":200,"timestamp":"2024-05-20 01:24:44","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/file/part/complete","x-request-id":"581a1b69-89aa-46d6-9f7b-d9a31747359e","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
45 total assertions[0m

=== RUN   TestFile/downloadParts

  test download parts file [32m✔[0m2024/05/20 01:24:44 /api/v1/file/metadata?key=443445555834654720%2Ftest%2Ftmp.bin,params:map[key:[443445555834654720/test/tmp.bin]]
{"elapsed":"219.283382ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/Metadata","status":200,"timestamp":"2024-05-20 01:24:44","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"HEAD","x-http-uri":"/api/v1/file/metadata?key=443445555834654720%2Ftest%2Ftmp.bin","x-request-id":"e9f140ee-16ca-4c6c-a937-a814f0cb4ff7","x-uid":""}
2024/05/20 01:24:44 /api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin,params:map[key:[443445555834654720/test/tmp.bin]]
{"elapsed":"790.04µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/DownloadForRange","status":200,"timestamp":"2024-05-20 01:24:44","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin","x-request-id":"7bbb017a-32c6-49ec-8747-a185f5857d73","x-uid":""}
2024/05/20 01:24:44 /api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin,params:map[key:[443445555834654720/test/tmp.bin]]
{"elapsed":"788.239µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/DownloadForRange","status":200,"timestamp":"2024-05-20 01:24:44","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin","x-request-id":"ad5ae4d8-0cd2-4536-aa27-8e6bb604c7d0","x-uid":""}
2024/05/20 01:24:44 /api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin,params:map[key:[443445555834654720/test/tmp.bin]]
{"elapsed":"805.62µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/DownloadForRange","status":200,"timestamp":"2024-05-20 01:24:44","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin","x-request-id":"f32d626e-b876-460c-87ab-c353e10a1610","x-uid":""}
2024/05/20 01:24:44 /api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin,params:map[key:[443445555834654720/test/tmp.bin]]
{"elapsed":"812.679µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/DownloadForRange","status":200,"timestamp":"2024-05-20 01:24:44","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin","x-request-id":"bb610525-47a1-4256-b993-0827b20b7f0b","x-uid":""}
2024/05/20 01:24:44 /api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin,params:map[key:[443445555834654720/test/tmp.bin]]
{"elapsed":"845.147µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/DownloadForRange","status":200,"timestamp":"2024-05-20 01:24:44","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin","x-request-id":"599ec726-2a61-4a4a-9276-94a05ffb0d56","x-uid":""}
2024/05/20 01:24:44 /api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin,params:map[key:[443445555834654720/test/tmp.bin]]
{"elapsed":"872.934µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/DownloadForRange","status":200,"timestamp":"2024-05-20 01:24:44","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin","x-request-id":"df187a65-032d-42c6-9763-c6fdd0436d8c","x-uid":""}
2024/05/20 01:24:44 /api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin,params:map[key:[443445555834654720/test/tmp.bin]]
{"elapsed":"851.186µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/DownloadForRange","status":200,"timestamp":"2024-05-20 01:24:44","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin","x-request-id":"f5095a37-80de-4655-8aec-0aa2b686ae08","x-uid":""}
2024/05/20 01:24:44 /api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin,params:map[key:[443445555834654720/test/tmp.bin]]
{"elapsed":"816.088µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/DownloadForRange","status":200,"timestamp":"2024-05-20 01:24:44","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin","x-request-id":"d44036ec-b75d-4a13-a770-a0539a244680","x-uid":""}
2024/05/20 01:24:44 /api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin,params:map[key:[443445555834654720/test/tmp.bin]]
{"elapsed":"828.849µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/DownloadForRange","status":200,"timestamp":"2024-05-20 01:24:44","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin","x-request-id":"1283e47d-d61a-4583-8349-cf3589d2c1cd","x-uid":""}
2024/05/20 01:24:44 /api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin,params:map[key:[443445555834654720/test/tmp.bin]]
{"elapsed":"788.968µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/DownloadForRange","status":200,"timestamp":"2024-05-20 01:24:44","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/file/part?key=443445555834654720%2Ftest%2Ftmp.bin","x-request-id":"4e8dded2-155a-45d7-8863-7dab7b3177f0","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
48 total assertions[0m

=== RUN   TestFile/deleteFile

  test delete file 2024/05/20 01:24:44 /api/v1/file?key=443445555834654720%2Ftest%2Fhelloworld.pb,params:map[key:[443445555834654720/test/helloworld.pb]]
{"elapsed":"422.761µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/Delete","status":200,"timestamp":"2024-05-20 01:24:44","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"DELETE","x-http-uri":"/api/v1/file?key=443445555834654720%2Ftest%2Fhelloworld.pb","x-request-id":"90dffba0-e1b2-4e87-ad88-86a2d2913792","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
51 total assertions[0m

--- PASS: TestFile (1.56s)
    --- PASS: TestFile/upload (0.08s)
    --- PASS: TestFile/download (0.00s)
    --- PASS: TestFile/uploadParts (1.06s)
    --- PASS: TestFile/downloadParts (0.41s)
    --- PASS: TestFile/deleteFile (0.00s)
=== RUN   TestEndpoint
=== RUN   TestEndpoint/post

  test create endpoint api [32m✔[0m2024/05/20 01:24:44 /api/v1/endpoint,params:map[]
2024/05/20 01:24:44 endpoint add tags :[test]
{"elapsed":"2.496828ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.EndpointService/Put","status":200,"timestamp":"2024-05-20 01:24:44","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/endpoint","x-request-id":"42c9f9a9-9057-4e12-baef-6aa3546b59f5","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/05/20 01:24:47 /api/v1/example/helloworld,params:map[name:[helloworld]]
{"elapsed":"1.334688ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-05-20 01:24:47","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/helloworld","x-request-id":"abb36721-8745-4109-9d6b-f2d331604405","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
58 total assertions[0m

=== RUN   TestEndpoint/patch

  test patch endpoint api 2024/05/20 01:24:47 /api/v1/endpoint,params:map[]
{"elapsed":"33.406075ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.EndpointService/Update","status":200,"timestamp":"2024-05-20 01:24:47","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"PATCH","x-http-uri":"/api/v1/endpoint","x-request-id":"490f03e4-1b09-4076-9d4c-bd5e2c9abccd","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
60 total assertions[0m

=== RUN   TestEndpoint/get

  test get endpoint api 2024/05/20 01:24:50 /api/v1/endpoint/447449544557334528,params:map[unique_key:[447449544557334528]]
{"elapsed":"599.711µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.EndpointService/Details","status":200,"timestamp":"2024-05-20 01:24:50","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/endpoint/447449544557334528","x-request-id":"1a620bbb-6b81-469f-b005-7a379d499e73","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
63 total assertions[0m

=== RUN   TestEndpoint/del

  test delete endpoint api 2024/05/20 01:24:50 /api/v1/endpoint/447449544557334528,params:map[unique_key:[447449544557334528]]
{"elapsed":"71.88135ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.EndpointService/Delete","status":200,"timestamp":"2024-05-20 01:24:50","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"DELETE","x-http-uri":"/api/v1/endpoint/447449544557334528","x-request-id":"3314ed50-23bb-498b-b043-b96602081312","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"WARNING","line":371,"message":"not found router","timestamp":"2024-05-20 01:24:55","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/helloworld","x-request-id":"5ff224e6-9a95-4385-8b5f-bd36321bbb75","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
68 total assertions[0m

--- PASS: TestEndpoint (11.13s)
    --- PASS: TestEndpoint/post (3.01s)
    --- PASS: TestEndpoint/patch (3.04s)
    --- PASS: TestEndpoint/get (0.00s)
    --- PASS: TestEndpoint/del (5.08s)
=== RUN   TestUser
=== RUN   TestUser/add_user

  test add user 2024/05/20 01:24:55 /api/v1/user,params:map[]
{"elapsed":"389.579851ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.UserService/Register","status":200,"timestamp":"2024-05-20 01:24:56","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/user","x-request-id":"0c8e122c-1eb9-40b6-85ef-06aa52cf4ad5","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
71 total assertions[0m

=== RUN   TestUser/get_user

  test get user 2024/05/20 01:24:56 /api/v1/user/447449591223160832,params:map[uid:[447449591223160832]]
{"elapsed":"565.534µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.UserService/Get","status":200,"timestamp":"2024-05-20 01:24:56","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/user/447449591223160832","x-request-id":"c5f6063c-671f-4a5e-a54d-bcd20592d9fa","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
73 total assertions[0m

=== RUN   TestUser/patch_user

  test patch user 2024/05/20 01:24:56 /api/v1/user/447449591223160832,params:map[uid:[447449591223160832]]
{"elapsed":"720.81154ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.UserService/Update","status":200,"timestamp":"2024-05-20 01:24:56","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"PATCH","x-http-uri":"/api/v1/user/447449591223160832","x-request-id":"51cb180e-8a95-49ae-82e8-a477da66fc40","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
75 total assertions[0m

=== RUN   TestUser/delete_user

  test delete user 2024/05/20 01:24:56 /api/v1/user/447449591223160832,params:map[uid:[447449591223160832]]
{"elapsed":"266.315665ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.UserService/Delete","status":200,"timestamp":"2024-05-20 01:24:57","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"DELETE","x-http-uri":"/api/v1/user/447449591223160832","x-request-id":"cf5a98be-6a3c-460b-a707-3616bf91fe8a","x-uid":""}
[32m✔[0m[32m✔[0m2024/05/20 01:24:57 /api/v1/user/447449591223160832,params:map[uid:[447449591223160832]]
{"elapsed":"552.357µs","file":"/data/work/begonia-org/begonia/internal/biz/user.go","fn":"github.com/begonia-org/begonia/internal/biz.(*UserUsecase).Get","level":"ERROR","line":58,"message":"rpc error: code = NotFound desc = get user failed: get model failed: record not found","module":"request","name":"/begonia.org.sdk.UserService/Get","status":4113,"timestamp":"2024-05-20 01:24:57","x-access-key":"3RzsFRuSKgsHF9FAE7NVqdhffb0whTje","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/user/447449591223160832","x-request-id":"f7a8c4e3-1be1-4def-8ad0-844a764d4638","x-uid":""}
{"file":"/data/work/begonia-org/begonia/internal/biz/user.go","fn":"github.com/begonia-org/begonia/internal/biz.(*UserUsecase).Get","level":"ERROR","line":58,"message":"get user failed: get model failed: record not found","status":404,"timestamp":"2024-05-20 01:24:57"}
[32m✔[0m

[31m[0m[33m[0m[32m
78 total assertions[0m

--- PASS: TestUser (1.39s)
    --- PASS: TestUser/add_user (0.39s)
    --- PASS: TestUser/get_user (0.00s)
    --- PASS: TestUser/patch_user (0.72s)
    --- PASS: TestUser/delete_user (0.27s)
PASS
	github.com/begonia-org/begonia/internal/service	coverage: 69.8% of statements
ok  	github.com/begonia-org/begonia/internal/service	21.643s	coverage: 69.8% of statements
FAIL
