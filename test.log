?   	github.com/begonia-org/begonia	[no test files]
?   	github.com/begonia-org/begonia/cmd/begonia	[no test files]
?   	github.com/begonia-org/begonia/config	[no test files]
?   	github.com/begonia-org/begonia/example	[no test files]
?   	github.com/begonia-org/begonia/internal	[no test files]
?   	github.com/begonia-org/begonia/internal/daemon	[no test files]
?   	github.com/begonia-org/begonia/internal/migrate	[no test files]
?   	github.com/begonia-org/begonia/internal/server	[no test files]
2024/06/04 02:15:40 config dir: /data/work/begonia-org/begonia/config
=== RUN   TestRequest

  test request [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
4 total assertions[0m

--- PASS: TestRequest (3.00s)
=== RUN   TestUnaryInterceptor

  TestUnaryInterceptor [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
10 total assertions[0m

--- PASS: TestUnaryInterceptor (0.00s)
=== RUN   TestFormDataContentType

  TestFormDataContentType [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
26 total assertions[0m

--- PASS: TestFormDataContentType (0.00s)
=== RUN   TestFormUrlEncodedContentType

  TestFormUrlEncodedContentType [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
32 total assertions[0m

--- PASS: TestFormUrlEncodedContentType (0.00s)
=== RUN   TestFormUrlEncodedErr

  TestFormUrlEncodedErr [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
37 total assertions[0m

--- PASS: TestFormUrlEncodedErr (0.00s)
=== RUN   TestFormDataDecodeErr

  TestFormDataDecodeErr [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
45 total assertions[0m

--- PASS: TestFormDataDecodeErr (0.00s)
=== RUN   TestFormDataValueErr

  test formdata value err [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
54 total assertions[0m

--- PASS: TestFormDataValueErr (0.00s)
=== RUN   TestGrpcHandleErr

  test grpc handle err [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
69 total assertions[0m

--- PASS: TestGrpcHandleErr (5.01s)
=== RUN   TestHttp
=== RUN   TestHttp/testRegisterClient

  test register client [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:15:52 Start on 127.0.0.1:7224
[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
82 total assertions[0m

=== RUN   TestHttp/testHttp2

  test http2 {"elapsed":"2.368332ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHello","status":200,"timestamp":"2024-06-04 02:15:57","x-access-key":"","x-http-forwarded-for":"","x-http-method":"","x-http-uri":"","x-request-id":"","x-uid":""}
[32m✔[0m    http_test.go:1188: begonia
[32m✔[0m

[31m[0m[33m[0m[32m
84 total assertions[0m

=== RUN   TestHttp/testRequestGet

  test request GET [32m✔[0m{"elapsed":"846.913µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-06-04 02:15:57","x-access-key":"12345678","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"6265d996-e9d5-4287-807a-526075a43055","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"elapsed":"725.927µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-06-04 02:15:57","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/http-code?msg=hello","x-request-id":"0b0eb2dc-5216-4f7a-ae72-4bd42852400d","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"Method Not Allowed","status":501,"timestamp":"2024-06-04 02:15:57","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47458","x-http-method":"POST","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"5da5ec6f-bd9f-4352-99ea-43914fa88029","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
100 total assertions[0m

=== RUN   TestHttp/testPanicRecover

  test panic recover [32m✔[0m{"elapsed":"31.689µs","file":"/data/work/begonia-org/begonia/gateway/exception.go","fn":"github.com/begonia-org/begonia/gateway.(*Exception).handlePanic","level":"ERROR","line":56,"message":"rpc error: code = Internal desc = panic: test panic\nStack trace:\ngithub.com/begonia-org/begonia/gateway.(*Exception).StreamInterceptor.func1\n\t/data/work/begonia-org/begonia/gateway/exception.go:70\nruntime.gopanic\n\t/data/work/go/src/runtime/panic.go:884\ngithub.com/begonia-org/begonia/gateway.testPanicRecover.func1.1\n\t/data/work/begonia-org/begonia/gateway/http_test.go:1174\ngoogle.golang.org/grpc.getChainStreamHandler.func1\n\t/data/work/go/pkg/mod/google.golang.org/grpc@v1.64.0/server.go:1525\ngithub.com/begonia-org/begonia/gateway.(*Exception).StreamInterceptor\n\t/data/work/begonia-org/begonia/gateway/exception.go:73\n","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":5000,"timestamp":"2024-06-04 02:15:57","x-access-key":"12345678","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello\u0026test=panic","x-request-id":"348a3584-3613-4bba-97bc-1be5b9bce123","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/exception.go","fn":"github.com/begonia-org/begonia/gateway.(*Exception).handlePanic","level":"ERROR","line":56,"message":"panic: test panic\nStack trace:\ngithub.com/begonia-org/begonia/gateway.(*Exception).StreamInterceptor.func1\n\t/data/work/begonia-org/begonia/gateway/exception.go:70\nruntime.gopanic\n\t/data/work/go/src/runtime/panic.go:884\ngithub.com/begonia-org/begonia/gateway.testPanicRecover.func1.1\n\t/data/work/begonia-org/begonia/gateway/http_test.go:1174\ngoogle.golang.org/grpc.getChainStreamHandler.func1\n\t/data/work/go/pkg/mod/google.golang.org/grpc@v1.64.0/server.go:1525\ngithub.com/begonia-org/begonia/gateway.(*Exception).StreamInterceptor\n\t/data/work/begonia-org/begonia/gateway/exception.go:73\n","status":500,"timestamp":"2024-06-04 02:15:57","x-access-key":"12345678","x-http-forwarded-for":"127.0.0.1:47462","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello\u0026test=panic","x-request-id":"b1cd7ae1-f44d-4fa1-8645-e388f147ead0","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
103 total assertions[0m

=== RUN   TestHttp/testCors

  test cors [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":71,"message":"origin:http://www.begonia-org.com not allowed","timestamp":"2024-06-04 02:15:57"}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
110 total assertions[0m

=== RUN   TestHttp/testRequestPost

  test request POST json [32m✔[0m{"elapsed":"921.786µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHello","status":200,"timestamp":"2024-06-04 02:15:57","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/post","x-request-id":"d16836b7-6c0a-4d81-a13b-63d06d7fdd28","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
117 total assertions[0m


  test request POST form-data [32m✔[0m[32m✔[0m{"elapsed":"813.926µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHello","status":200,"timestamp":"2024-06-04 02:15:57","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/post","x-request-id":"335b65fe-c036-4e74-be37-5356a736e491","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
125 total assertions[0m


  test request POST form-urlencoded [32m✔[0m{"elapsed":"1.694342ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHello","status":200,"timestamp":"2024-06-04 02:15:57","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/post","x-request-id":"609b2cba-0bbf-4719-95a3-96eec46f3f18","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
132 total assertions[0m


  test request POST binary [32m✔[0m{"elapsed":"838.439µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloBody","status":200,"timestamp":"2024-06-04 02:15:57","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/body","x-request-id":"893f2c79-2b00-4fcf-b799-f7a63deddf35","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
140 total assertions[0m

=== RUN   TestHttp/testServerSideEvent

  test server side event {"elapsed":"909.645µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloServerSideEvent","status":200,"timestamp":"2024-06-04 02:15:57","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/sse/world?msg=hello\u0026stream=message","x-request-id":"a8419936-43c4-4568-8733-8af20c48b932","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
161 total assertions[0m

=== RUN   TestHttp/testWebsocket

  test websocket [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
202 total assertions[0m

=== RUN   TestHttp/testClientStreamRequest

  test client stream request [32m✔{"elapsed":"2.803112ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloWebsocket","status":200,"timestamp":"2024-06-04 02:15:57","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/websocket","x-request-id":"92e77d7a-55ac-4903-aaf2-c7639d2fc6ce","x-uid":""}
[0m{"elapsed":"756.196µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":200,"timestamp":"2024-06-04 02:15:57","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"79a28caa-548a-4e0f-aa1d-9e64385d5de6","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
218 total assertions[0m

=== RUN   TestHttp/testClientStreamRequestByMarshal

  test client stream request [32m✔[0m{"elapsed":"734.079µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":200,"timestamp":"2024-06-04 02:15:57","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"dd6b24d0-ecd4-4984-b06c-6f40b177cd45","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
242 total assertions[0m

=== RUN   TestHttp/testLoadGlobalTypes

  test load global types [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
249 total assertions[0m

=== RUN   TestHttp/testUpdateLoadbalance

  test update loadbalance [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"elapsed":"4.025423ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"91da59de-4c41-45ac-883c-775609ede18d","x-uid":""}
{"elapsed":"1.330702ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"cd2f8390-8615-449b-9eec-e48e310bc6e9","x-uid":""}
{"elapsed":"4.441393ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"a0dc0bf8-bb8c-4ade-a9a0-d8b7109ff65f","x-uid":""}
{"elapsed":"4.801304ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"16f2c88f-c0db-4503-ac03-23c1d4fbf9fb","x-uid":""}
{"elapsed":"2.007205ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"0cf18e6d-7fa5-484f-8d61-26b42023b665","x-uid":""}
{"elapsed":"30.849991ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"88511525-b0d8-45f9-b417-9e019950d751","x-uid":""}
{"elapsed":"30.319303ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"b8839acb-d4f3-4024-973d-aafdf8237da4","x-uid":""}
{"elapsed":"28.777757ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"e88e9b2c-3f8e-4e46-9500-3cd5980b8ec1","x-uid":""}
{"elapsed":"27.76696ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"3d2bff1a-81c7-4063-bb5f-5c42d54346ce","x-uid":""}
{"elapsed":"26.90546ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"98660b30-51ab-480a-b9cd-f2503fe99f84","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
272 total assertions[0m

=== RUN   TestHttp/testHttpError

  test http error [32m✔[0m[32m✔[0m2024/06/04 02:16:00 SayHelloError: ok,code:0
{"elapsed":"914.085µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloError","status":200,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=0","x-request-id":"a80594e0-40a9-4684-a950-446d0db12c79","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:16:00 SayHelloError: ok,code:13
{"elapsed":"859.43µs","file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":145,"message":"rpc error: code = Internal desc = ok","module":"request","name":"/helloworld.Greeter/SayHelloError","status":5000,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=13","x-request-id":"04428061-b0cd-4e68-998f-420d66e9e8e4","x-uid":""}
{"file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":145,"message":"ok","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47570","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=13","x-request-id":"4835e246-186b-40c6-bb7a-339ae6864e17","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:16:00 SayHelloError: ok,code:3
{"elapsed":"712.222µs","file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":142,"message":"rpc error: code = InvalidArgument desc = ok","module":"request","name":"/helloworld.Greeter/SayHelloError","status":4000,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=3","x-request-id":"47024291-c101-4387-8a55-b76d8ddf9063","x-uid":""}
{"file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":142,"message":"ok","status":400,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47572","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=3","x-request-id":"f00421c6-f47f-4296-b53f-74c9ca56c26b","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:16:00 SayHelloError: ok,code:5
{"elapsed":"711.575µs","file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":147,"message":"rpc error: code = NotFound desc = ok","module":"request","name":"/helloworld.Greeter/SayHelloError","status":4004,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=5","x-request-id":"5720bc6c-b39d-4207-a8e0-c1121b57b98a","x-uid":""}
{"file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":147,"message":"ok","status":404,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47586","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=5","x-request-id":"0c60c495-98d5-499a-bac5-ea01cf3aa4eb","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:16:00 SayHelloError: ok,code:7
{"elapsed":"892.216µs","file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":149,"message":"rpc error: code = PermissionDenied desc = ok","module":"request","name":"/helloworld.Greeter/SayHelloError","status":4001,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=7","x-request-id":"b0259373-6da0-40f3-94c6-87cb1d4c93ba","x-uid":""}
{"file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":149,"message":"ok","status":403,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47592","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=7","x-request-id":"e3645b50-9b60-4cbf-875c-f8dc7da6d0a0","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:16:00 SayHelloError: ok,code:16
{"elapsed":"708.39µs","file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":151,"message":"rpc error: code = Unauthenticated desc = ok","module":"request","name":"/helloworld.Greeter/SayHelloError","status":4001,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=16","x-request-id":"bd86e53d-6e6f-4e96-8aab-5e74c2290762","x-uid":""}
{"file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":151,"message":"ok","status":401,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47594","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=16","x-request-id":"c8be4eb9-4df1-496f-b575-3240e17a64f8","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:16:00 SayHelloError: ok,code:8
{"elapsed":"698.568µs","file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":161,"message":"rpc error: code = ResourceExhausted desc = ok","module":"request","name":"/helloworld.Greeter/SayHelloError","status":4008,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=8","x-request-id":"348e239e-e9a5-4c55-8a11-4beb59e6e070","x-uid":""}
{"file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":161,"message":"ok","status":429,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47606","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=8","x-request-id":"6ceae848-4cbf-42a4-807c-8128fe00113b","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:16:00 SayHelloError: ok,code:4
{"elapsed":"705.665µs","file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":159,"message":"rpc error: code = DeadlineExceeded desc = ok","module":"request","name":"/helloworld.Greeter/SayHelloError","status":5004,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=4","x-request-id":"6b82a5dc-957f-4ae1-9748-f70ae79b39b1","x-uid":""}
{"file":"/data/work/begonia-org/begonia-go-sdk/example/server.go","fn":"github.com/begonia-org/go-sdk/example.(*server).SayHelloError","level":"ERROR","line":159,"message":"ok","status":504,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47622","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=4","x-request-id":"8e17ae2e-a21b-40b2-ab27-8c8bc1dd2549","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:16:00 SayHelloError: ok,code:99999
{"elapsed":"775.275µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloError","status":200,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=99999","x-request-id":"13a31d72-6999-470e-bd29-160c13cca083","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"HttpResponseBodyModify","level":"ERROR","line":336,"message":"strconv.ParseInt: parsing \"test\": invalid syntax","timestamp":"2024-06-04 02:16:00"}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"strconv.ParseInt: parsing \"test\": invalid syntax","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47634","x-http-method":"GET","x-http-uri":"/api/v1/example/error/test?msg=ok\u0026code=99999","x-request-id":"3e5998ab-51af-455f-8192-12e0144fc10e","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
308 total assertions[0m

=== RUN   TestHttp/testWebSocketError

  test websocket error [32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"WARNING","line":465,"message":"Failed to start websocket request: Failed to start websocket request: test stream error","timestamp":"2024-06-04 02:16:00"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"WARNING","line":465,"message":"Failed to start websocket request: Failed to get header from websocket client: test header error","timestamp":"2024-06-04 02:16:00"}
{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func2","level":"WARNING","line":182,"message":"Failed to send websocket request: read tcp 127.0.0.1:7224-\u003e127.0.0.1:47650: use of closed network connection","timestamp":"2024-06-04 02:16:00"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func2","level":"WARNING","line":182,"message":"Failed to send websocket request: test send error","timestamp":"2024-06-04 02:16:00"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"elapsed":"687.572µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Canceled desc = context canceled","module":"request","name":"/helloworld.Greeter/SayHelloWebsocket","status":499,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/websocket","x-request-id":"9a9abca5-9592-4ea2-8c62-d3861785a475","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func2","level":"WARNING","line":182,"message":"Failed to send websocket request: Failed to decode websocket request: test BIN DECODE error","timestamp":"2024-06-04 02:16:00"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func2","level":"WARNING","line":182,"message":"Failed to send websocket request: Failed to send request: test send error","timestamp":"2024-06-04 02:16:00"}
[32m✔[0m[32m✔[0m{"elapsed":"944.097µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloWebsocket","status":200,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/websocket","x-request-id":"6c1fbed3-bd82-4457-b5eb-5404db747046","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"ERROR","line":456,"message":"Failed to upgrade to websocket: test upgrade error","timestamp":"2024-06-04 02:16:00"}
[32m✔[0m{"elapsed":"1.25301ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloWebsocket","status":200,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/websocket","x-request-id":"59022adc-bf39-4dcf-a6cf-610705c8221c","x-uid":""}
[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"WARNING","line":465,"message":"Failed to start websocket request: Failed to start websocket request: test get conn error","timestamp":"2024-06-04 02:16:00"}
[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"WARNING","line":465,"message":"Failed to start websocket request: Failed to start websocket request: test new stream error","timestamp":"2024-06-04 02:16:00"}
[32m✔[0m[32m{"elapsed":"1.57092ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"test new stream error","module":"request","name":"/helloworld.Greeter/SayHelloWebsocket","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/websocket","x-request-id":"40e2aeeb-3f1f-404f-bdf4-40a91e35c389","x-uid":""}
✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:16:00 http: response.WriteHeader on hijacked connection from github.com/grpc-ecosystem/grpc-gateway/v2/runtime.handleForwardResponseStreamError (handler.go:208)


[31m[0m[33m[0m[32m
337 total assertions[0m

=== RUN   TestHttp/testServerSideEventErr

  test server side event error {"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":288,"message":"error type:*fmt.wrapError, error:Failed to add request params: test inParamsHandle error","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47716","x-http-method":"GET","x-http-uri":"/api/v1/example/server/sse/world?msg=hello\u0026stream=message","x-request-id":"2e7a86ff-0319-4463-8b97-35e5ce8b80f4","x-uid":""}
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":288,"message":"error type:*fmt.wrapError, error:Failed to start streaming: test ServerSideStream error","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47716","x-http-method":"GET","x-http-uri":"/api/v1/example/server/sse/world?msg=hello\u0026stream=message","x-request-id":"c22a4623-1265-4bb2-88f9-7fc8f7ef90c6","x-uid":""}
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":288,"message":"error type:*fmt.wrapError, error:Failed to get header from client: test header error","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47716","x-http-method":"GET","x-http-uri":"/api/v1/example/server/sse/world?msg=hello\u0026stream=message","x-request-id":"3be281f7-0ef4-4259-bb0c-d5dcb72fb4c6","x-uid":""}
[32m✔[0m{"elapsed":"26.542µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Unavailable desc = no endpoint available from endpoint,context canceled","module":"request","name":"/helloworld.Greeter/SayHelloServerSideEvent","status":503,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/sse/world?msg=hello\u0026stream=message","x-request-id":"44cf0cf1-8284-41a6-ab3b-5e77f94225ad","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":288,"message":"error type:*fmt.wrapError, error:Failed to start streaming: test get conn error","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47716","x-http-method":"GET","x-http-uri":"/api/v1/example/server/sse/world?msg=hello\u0026stream=message","x-request-id":"548413f0-3e1b-42fa-a389-b2c90699f74c","x-uid":""}
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":288,"message":"error type:*fmt.wrapError, error:Failed to start streaming: test new stream error","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47716","x-http-method":"GET","x-http-uri":"/api/v1/example/server/sse/world?msg=hello\u0026stream=message","x-request-id":"93ff0516-7139-4ab2-a4ce-b4ba32670fe6","x-uid":""}
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":288,"message":"error type:*fmt.wrapError, error:Failed to start streaming: test send error","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47716","x-http-method":"GET","x-http-uri":"/api/v1/example/server/sse/world?msg=hello\u0026stream=message","x-request-id":"4ad68a2b-46da-4894-8242-6dd03bf1f03d","x-uid":""}
[32m✔[0m{"elapsed":"664.572µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Canceled desc = context canceled","module":"request","name":"/helloworld.Greeter/SayHelloServerSideEvent","status":499,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/sse/world?msg=hello\u0026stream=message","x-request-id":"5f9d167d-71a9-4788-ba98-fb901cfe2a42","x-uid":""}
{"elapsed":"812.605µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloServerSideEvent","status":200,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/server/sse/world?msg=hello\u0026stream=message","x-request-id":"7570ed94-c899-4529-8005-5d4bbe400925","x-uid":""}
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"test decode error","status":400,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47724","x-http-method":"GET","x-http-uri":"/api/v1/example/server/sse/world?msg=hello\u0026stream=message","x-request-id":"2baa2254-b7bc-4a4d-91e4-d37e484c10b1","x-uid":""}
[32m✔[0m

[31m[0m[33m[0m[32m
345 total assertions[0m

=== RUN   TestHttp/testClientStreamErr

  test client stream error [32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":288,"message":"error type:*errors.errorString, error:test ClientSideStream error","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47732","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"e693d848-bc15-4a1a-800f-289f78a72ea4","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:977: data:
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"Failed to decode request:test NewDecoder error","status":400,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47732","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"fe318924-bd69-4f37-ab5a-038a9e9bfff8","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:977: data:{"message":"Unknown error","code":5000}
{"elapsed":"22.554µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Unavailable desc = no endpoint available from endpoint,context canceled","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":503,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"0d278dbf-11b6-48fe-92ba-23ba86083079","x-uid":""}
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"Failed to add request params:test inParamsHandle error","status":400,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47732","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"62f8938c-cceb-4191-a433-6a4b15954d09","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:977: data:{"message":"Unknown error","code":5000}
{"elapsed":"19.076µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Unavailable desc = no endpoint available from endpoint,context canceled","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":503,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"9f1b4673-c27e-4e56-9ff0-0edb50ff8a50","x-uid":""}
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"Failed to send request:test client stream send error","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47732","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"17a59bff-1449-41c8-93bb-0e1d057c5cfa","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:977: data:{"message":"Unknown error","code":5000}
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":288,"message":"error type:*fmt.wrapError, error:Failed to close send: test client stream close error","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47732","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"893133ae-0c0e-4e46-83a4-9629383d79a0","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:977: data:
[32m✔[0m{"elapsed":"21.594µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Unavailable desc = no endpoint available from endpoint,context canceled","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":503,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"b0011927-9504-4d15-9a2a-55dec01703bf","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":288,"message":"error type:*fmt.wrapError, error:Failed to get header from client: test header error","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47732","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"85aea5d0-dbdb-4f23-891d-6ad9d9e44fe6","x-uid":""}
{"elapsed":"617.878µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Canceled desc = context canceled","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":499,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"53f34756-ae98-462a-91c4-2a0bcf968c8b","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:977: data:
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":288,"message":"error type:*errors.errorString, error:test get conn error","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47732","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"e194db5c-59d2-4bbe-9cd5-3e2faeb03531","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:977: data:
[32m✔[0m{"elapsed":"536.343µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"test new stream error","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"30217c83-e641-46ba-86c9-73ffe8d46c10","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":288,"message":"error type:*errors.errorString, error:test new stream error","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47732","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"f9383afd-dc8b-4dd9-a749-955db333a7b6","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:977: data:
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"Failed to decode request:failed to unmarshal message from HttpProtobufStreamImpl: test unmarshal error","status":400,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47732","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"ae63859b-0626-42a2-ab54-b599f0243e37","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:977: data:{"message":"Unknown error","code":5000}


[31m[0m[33m[0m[32m
372 total assertions[0m

=== RUN   TestHttp/testAddHexEncodeSHA256HashV2Err

  test add hex encode sha256 hash v2 err [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
375 total assertions[0m

=== RUN   TestHttp/testRegisterHandlerClientErr

  test register handler client err [32m✔[0m{"elapsed":"621.495µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Canceled desc = context canceled","module":"request","name":"/helloworld.Greeter/SayHelloClientStream","status":499,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/example/client/stream","x-request-id":"afdeef7b-a82e-4537-ba42-23b18a1f669b","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
379 total assertions[0m

=== RUN   TestHttp/testRequestError

  test request error     http_test.go:661: test error test case:0
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"decode request body err test json decode error","status":400,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47732","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"e4086938-e2f5-44bb-a2b5-1954a9fea5d2","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:661: test error test case:1
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"Failed to add request params: test inParamsHandle error","status":400,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47744","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"1070b831-c779-40bd-8f96-8125bac78124","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:661: test error test case:2
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":288,"message":"error type:*fmt.wrapError, error:Failed to add sha256 hash: test io copy error","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47754","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"0377b9c9-eec9-46aa-bfaf-e44b897dd925","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:661: test error test case:3
[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":288,"message":"error type:*errors.errorString, error:test AnnotateContext error","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47754","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"b0f3c28c-ee36-465f-ae4f-55f28a515496","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:661: test error test case:4
[32m✔[0m{"elapsed":"13.056µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Internal desc = stream not exists in context","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"cedc6e8c-6444-4d4e-8495-5bc2024df0a5","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"stream not exists in context","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47754","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"d69357a4-3438-458c-ac58-0dcd6be2d7b4","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:661: test error test case:5
[32m✔[0m{"elapsed":"19.585µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Unavailable desc = no source ip","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":503,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"d0a10720-3a11-44b7-806b-d7f3766abeef","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"no source ip","status":503,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47760","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"0dec3741-1b95-42ba-91e2-e1acad878b04","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:661: test error test case:6
[32m✔[0m{"elapsed":"47.929µs","file":"/data/work/begonia-org/begonia/gateway/exception.go","fn":"github.com/begonia-org/begonia/gateway.(*Exception).handlePanic","level":"ERROR","line":56,"message":"rpc error: code = Internal desc = panic: reflect.Set: value of type *errors.errorString is not assignable to type []string\nStack trace:\ngithub.com/begonia-org/begonia/gateway.(*Exception).StreamInterceptor.func1\n\t/data/work/begonia-org/begonia/gateway/exception.go:70\nruntime.gopanic\n\t/data/work/go/src/runtime/panic.go:884\nreflect.Value.assignTo\n\t/data/work/go/src/reflect/value.go:3245\nreflect.Value.Set\n\t/data/work/go/src/reflect/value.go:2236\ngithub.com/agiledragon/gomonkey/v2.GetResultValues\n\t/data/work/go/pkg/mod/github.com/agiledragon/gomonkey/v2@v2.11.0/patch.go:320\n","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":5000,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"c71b81f1-ddf4-4131-a5a5-fab4f3117acb","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/exception.go","fn":"github.com/begonia-org/begonia/gateway.(*Exception).handlePanic","level":"ERROR","line":56,"message":"panic: reflect.Set: value of type *errors.errorString is not assignable to type []string\nStack trace:\ngithub.com/begonia-org/begonia/gateway.(*Exception).StreamInterceptor.func1\n\t/data/work/begonia-org/begonia/gateway/exception.go:70\nruntime.gopanic\n\t/data/work/go/src/runtime/panic.go:884\nreflect.Value.assignTo\n\t/data/work/go/src/reflect/value.go:3245\nreflect.Value.Set\n\t/data/work/go/src/reflect/value.go:2236\ngithub.com/agiledragon/gomonkey/v2.GetResultValues\n\t/data/work/go/pkg/mod/github.com/agiledragon/gomonkey/v2@v2.11.0/patch.go:320\n","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47776","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"075aeeb5-d8d7-402c-ac1f-fa53af8d9b5d","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:661: test error test case:7
[32m✔[0m{"elapsed":"19.725µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Unavailable desc = no endpoint available to select,test select error","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":503,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"c1af2934-3f46-48ff-b9f4-9d98f20210e3","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"no endpoint available to select,test select error","status":503,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47788","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"b15d37d2-fcc1-4915-8e28-3b873bd62954","x-uid":""}
[32m✔[0m[32m✔[0m    http_test.go:661: test error test case:8
[32m✔[0m{"elapsed":"586.779µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"rpc error: code = Internal desc = failed proxying s2c: test forwardServerToClient error","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"d529dbfc-1a8b-4ea0-a477-a1548925eaff","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"failed proxying s2c: test forwardServerToClient error","status":500,"timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1:47804","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"36e1f34c-fbc2-4a7d-8df0-c73e9a3cac0f","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
406 total assertions[0m

=== RUN   TestHttp/testLoadHttpEndpointItemErr

  test load http endpoint item [32m✔[0m[32m✔[0m2024/06/04 02:16:00 config dir: /data/work/begonia-org/begonia/config
    http_test.go:1021: err test case:0
[32m✔[0m2024/06/04 02:16:00 config dir: /data/work/begonia-org/begonia/config
    http_test.go:1021: err test case:1
[32m✔[0m2024/06/04 02:16:00 config dir: /data/work/begonia-org/begonia/config
    http_test.go:1021: err test case:2
[32m✔[0m

[31m[0m[33m[0m[32m
411 total assertions[0m

=== RUN   TestHttp/testDeleteEndpoint

  test delete endpoint [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"WARNING","line":363,"message":"not found router","timestamp":"2024-06-04 02:16:00","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"f262f8f7-9c06-4181-9e60-c4841fe40ff4","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
420 total assertions[0m

=== RUN   TestHttp/testRegisterLocalService

  test register local service [32m✔[0m[32m✔[0m2024/06/04 02:16:00 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m2024/06/04 02:16:01 Start on 127.0.0.1:6054
[32m✔[0m{"elapsed":"20.786µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-06-04 02:16:03","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"a3632239-1584-448d-80df-770ca1b9fc72","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
432 total assertions[0m


  test del local service [32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"WARNING","line":363,"message":"not found router","timestamp":"2024-06-04 02:16:03","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/world?msg=hello","x-request-id":"9715d90e-9ad4-4e01-a494-4bd097bf60d3","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
435 total assertions[0m

=== RUN   TestHttp/testStartErr

  test start error [32m✔[0m[32m✔[0m2024/06/04 02:16:03 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m2024/06/04 02:16:03 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m2024/06/04 02:16:04 Start on 127.0.0.1:8566
2024/06/04 02:16:06 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m2024/06/04 02:16:07 Start on 127.0.0.1:7224
[32m✔[0m

[31m[0m[33m[0m[32m
442 total assertions[0m

--- PASS: TestHttp (18.18s)
    --- PASS: TestHttp/testRegisterClient (8.01s)
    --- PASS: TestHttp/testHttp2 (0.00s)
    --- PASS: TestHttp/testRequestGet (0.00s)
    --- PASS: TestHttp/testPanicRecover (0.00s)
    --- PASS: TestHttp/testCors (0.00s)
    --- PASS: TestHttp/testRequestPost (0.01s)
    --- PASS: TestHttp/testServerSideEvent (0.00s)
    --- PASS: TestHttp/testWebsocket (0.00s)
    --- PASS: TestHttp/testClientStreamRequest (0.00s)
    --- PASS: TestHttp/testClientStreamRequestByMarshal (0.00s)
    --- PASS: TestHttp/testLoadGlobalTypes (0.02s)
    --- PASS: TestHttp/testUpdateLoadbalance (3.05s)
    --- PASS: TestHttp/testHttpError (0.01s)
    --- PASS: TestHttp/testWebSocketError (0.00s)
    --- PASS: TestHttp/testServerSideEventErr (0.00s)
    --- PASS: TestHttp/testClientStreamErr (0.00s)
    --- PASS: TestHttp/testAddHexEncodeSHA256HashV2Err (0.00s)
    --- PASS: TestHttp/testRegisterHandlerClientErr (0.01s)
    --- PASS: TestHttp/testRequestError (0.00s)
    --- PASS: TestHttp/testLoadHttpEndpointItemErr (0.01s)
    --- PASS: TestHttp/testDeleteEndpoint (0.01s)
    --- PASS: TestHttp/testRegisterLocalService (3.01s)
    --- PASS: TestHttp/testStartErr (4.01s)
=== RUN   TestLog

  TestLog {"file":"/data/work/begonia-org/begonia/gateway/logger_test.go","fn":"func1","level":"INFO","line":14,"message":"info","timestamp":"2024-06-04 02:16:07"}
{"file":"/data/work/begonia-org/begonia/gateway/logger_test.go","fn":"func1","level":"WARNING","line":15,"message":"warn","timestamp":"2024-06-04 02:16:07"}
{"file":"/data/work/begonia-org/begonia/gateway/logger_test.go","fn":"func1","level":"INFO","line":16,"message":"infof","timestamp":"2024-06-04 02:16:07"}
{"file":"/data/work/begonia-org/begonia/gateway/logger_test.go","fn":"func1","level":"INFO","line":19,"message":"infof","timestamp":"2024-06-04 02:16:07","x-access-key":"","x-http-forwarded-for":"","x-http-method":"","x-http-uri":"","x-request-id":"","x-uid":""}
{"file":"/data/work/go/pkg/mod/github.com/smartystreets/goconvey@v1.8.1/convey/discovery.go","fn":"func1","level":"INFO","line":89,"message":"info","timestamp":"2024-06-04 02:16:07"}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
444 total assertions[0m

--- PASS: TestLog (0.00s)
=== RUN   TestMask

  TestMask [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
453 total assertions[0m

--- PASS: TestMask (0.00s)
=== RUN   TestDecodeErr

  TestDecodeErr [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
459 total assertions[0m

--- PASS: TestDecodeErr (0.00s)
=== RUN   TestProtobufDescriptionErr
=== RUN   TestProtobufDescriptionErr/Test_initDescriptorSet_error

  Test initDescriptorSet error [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
462 total assertions[0m

=== RUN   TestProtobufDescriptionErr/Test_SetHttpResponse_error

  Test SetHttpResponse error [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
470 total assertions[0m

=== RUN   TestProtobufDescriptionErr/Test_NewDescription_error

  Test NewDescription error [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
480 total assertions[0m

=== RUN   TestProtobufDescriptionErr/Test_NewDescriptionFromBinary_error

  Test NewDescriptionFromBinary error [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
495 total assertions[0m

--- PASS: TestProtobufDescriptionErr (0.10s)
    --- PASS: TestProtobufDescriptionErr/Test_initDescriptorSet_error (0.01s)
    --- PASS: TestProtobufDescriptionErr/Test_SetHttpResponse_error (0.02s)
    --- PASS: TestProtobufDescriptionErr/Test_NewDescription_error (0.06s)
    --- PASS: TestProtobufDescriptionErr/Test_NewDescriptionFromBinary_error (0.02s)
=== RUN   TestRawBinaryUnmarshaler

  TestRawBinaryUnmarshaler [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
506 total assertions[0m

--- PASS: TestRawBinaryUnmarshaler (0.00s)
=== RUN   TestRawBinaryDecodeErr

  TestRawBinaryDecodeErr [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
512 total assertions[0m

--- PASS: TestRawBinaryDecodeErr (0.00s)
=== RUN   TestClientSideStreamClient

  test clientSideStreamClient [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
516 total assertions[0m

--- PASS: TestClientSideStreamClient (0.00s)
=== RUN   TestBuildGrpcRequest

  TestBuildGrpcRequest [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
525 total assertions[0m

--- PASS: TestBuildGrpcRequest (0.00s)
=== RUN   TestNewEndpoint

  TestNewEndpoint [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
533 total assertions[0m

--- PASS: TestNewEndpoint (0.00s)
=== RUN   TestJSONCamelCase

  TestJSONCamelCase [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
537 total assertions[0m

--- PASS: TestJSONCamelCase (0.00s)
PASS
	github.com/begonia-org/begonia/gateway	coverage: 97.6% of statements
ok  	github.com/begonia-org/begonia/gateway	26.419s	coverage: 97.6% of statements
2024/06/04 02:15:41 Start testing
=== RUN   TestAKSK
=== RUN   TestAKSK/get_secret
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  get secret [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
2 total assertions[0m


  get secret fail {"file":"/data/work/begonia-org/go-layered-cache/kv.go","fn":"Get","level":"ERROR","line":103,"message":"local.Get test:begonia:kv:app:access_key:ddddeeeeeedede error:Entry not found","timestamp":"2024-06-04 02:15:42"}
[32m✔[0m

[31m[0m[33m[0m[32m
3 total assertions[0m

=== RUN   TestAKSK/get_appid
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  get appid [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
5 total assertions[0m


  get appid fail {"file":"/data/work/begonia-org/go-layered-cache/kv.go","fn":"Get","level":"ERROR","line":103,"message":"local.Get test:begonia:kv:app:appid:dddddeeedwecccwcqdq error:Entry not found","timestamp":"2024-06-04 02:15:42"}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
7 total assertions[0m

=== RUN   TestAKSK/validator

  test validator success [32m✔[0m[32m✔[0m2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
11 total assertions[0m


  test validator fail with missing key params [32m✔[0m[32m✔[0m2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
23 total assertions[0m


  test validator fail with invalidate sk ak [32m✔[0m[32m✔[0m2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
29 total assertions[0m

=== RUN   TestAKSK/if_need_validate

  test if need validate [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
31 total assertions[0m

--- PASS: TestAKSK (1.39s)
    --- PASS: TestAKSK/get_secret (1.38s)
    --- PASS: TestAKSK/get_appid (0.00s)
    --- PASS: TestAKSK/validator (0.00s)
    --- PASS: TestAKSK/if_need_validate (0.00s)
=== RUN   TestAppBiz
=== RUN   TestAppBiz/testPutApp
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test app put success [32m✔[0m2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
34 total assertions[0m


  test app put failed [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
47 total assertions[0m

=== RUN   TestAppBiz/testGetApp
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test app get success [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
53 total assertions[0m


  test app get failed [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
55 total assertions[0m

=== RUN   TestAppBiz/testPatchApp
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test app patch success [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
68 total assertions[0m


  test app patch failed [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
74 total assertions[0m

=== RUN   TestAppBiz/testListApp
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test app list success [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
77 total assertions[0m


  test app list failed [32m✔[0m[32m✔[0m2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
81 total assertions[0m

=== RUN   TestAppBiz/testCache
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test app cache success [32m✔[0m

[31m[0m[33m[0m[32m
82 total assertions[0m

=== RUN   TestAppBiz/testDelApp
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test app del success [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
85 total assertions[0m


  test app del failed [32m✔[0m[32m✔[0m2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
89 total assertions[0m

--- PASS: TestAppBiz (0.05s)
    --- PASS: TestAppBiz/testPutApp (0.02s)
    --- PASS: TestAppBiz/testGetApp (0.00s)
    --- PASS: TestAppBiz/testPatchApp (0.01s)
    --- PASS: TestAppBiz/testListApp (0.01s)
    --- PASS: TestAppBiz/testCache (0.00s)
    --- PASS: TestAppBiz/testDelApp (0.01s)
=== RUN   TestAuthz
=== RUN   TestAuthz/test_auth_seed
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test auth seed [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
92 total assertions[0m

=== RUN   TestAuthz/test_login
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test login success [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
95 total assertions[0m


  test login failed with invalid password [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
99 total assertions[0m


  test login failed with invalid account [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
103 total assertions[0m


  test login failed with invalid pub key [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
106 total assertions[0m


  test login failed with invalid seed token expiration [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
110 total assertions[0m


  test login failed with invalid UserAuth [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
112 total assertions[0m


  test login failed with invalid EncryptAES [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
114 total assertions[0m


  test login failed with invalid user status [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
117 total assertions[0m


  test login failed with jwt generate error [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
119 total assertions[0m

=== RUN   TestAuthz/test_logout
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test logout success [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
122 total assertions[0m


  test logout fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
128 total assertions[0m

=== RUN   TestAuthz/test_del_token

  test del token 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m

[31m[0m[33m[0m[32m
129 total assertions[0m

=== RUN   TestAuthz/test_put_black_list
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test put black list [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
132 total assertions[0m

--- PASS: TestAuthz (0.28s)
    --- PASS: TestAuthz/test_auth_seed (0.00s)
    --- PASS: TestAuthz/test_login (0.27s)
    --- PASS: TestAuthz/test_logout (0.00s)
    --- PASS: TestAuthz/test_del_token (0.00s)
    --- PASS: TestAuthz/test_put_black_list (0.00s)
=== RUN   TestDo
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test data operator do success [32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"Do","level":"INFO","line":62,"message":"start watch","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"Do","level":"INFO","line":62,"message":"start watch","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:42"}
2024/06/04 02:15:42 lockKey:test:begonia:user:black:lock
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:42"}
2024/06/04 02:15:42 lockKey:test:begonia:user:black:lock
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:42"}
2024/06/04 02:15:42 lastUpdate:0001-01-01 00:00:00 +0000 UTC
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"loadUsersBlacklist","level":"INFO","line":134,"message":"load users:1","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":123,"message":"unlock success","timestamp":"2024-06-04 02:15:42"}
2024/06/04 02:15:44 lastUpdate:2024-06-04 02:15:44.202 +0800 CST
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"loadUsersBlacklist","level":"INFO","line":134,"message":"load users:1","timestamp":"2024-06-04 02:15:44"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":123,"message":"unlock success","timestamp":"2024-06-04 02:15:44"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"Do","level":"INFO","line":62,"message":"start watch","timestamp":"2024-06-04 02:15:47"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"ERROR","line":55,"message":"test data operator on start error","timestamp":"2024-06-04 02:15:47"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"ERROR","line":58,"message":"test data watcher list error","timestamp":"2024-06-04 02:15:47"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:47"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:47"}
2024/06/04 02:15:47 lockKey:test:begonia:user:black:lock
2024/06/04 02:15:47 lastUpdate:2024-06-04 02:15:44.904 +0800 CST
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":123,"message":"unlock success","timestamp":"2024-06-04 02:15:47"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:48"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func2","level":"ERROR","line":89,"message":"expiration time is too short","timestamp":"2024-06-04 02:15:48"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:48"}


[31m[0m[33m[0m[32m
139 total assertions[0m

--- PASS: TestDo (7.02s)
=== RUN   TestHandleError
2024/06/04 02:15:49 config dir: /data/work/begonia-org/begonia/config

  test data operator handle error 2024/06/04 02:15:49 config dir: /data/work/begonia-org/begonia/config
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:49"}
2024/06/04 02:15:49 lockKey:test:begonia:user:black:lock
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:49"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func2","level":"ERROR","line":89,"message":"get lock error:test new lock error","timestamp":"2024-06-04 02:15:49"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:50"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:50"}
2024/06/04 02:15:50 lockKey:test:begonia:user:black:lock
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func2","level":"ERROR","line":89,"message":"lock error: test lock error","timestamp":"2024-06-04 02:15:50"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:51"}
2024/06/04 02:15:51 lockKey:test:begonia:user:black:lock
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:51"}
2024/06/04 02:15:51 lastUpdate:0001-01-01 00:00:00 +0000 UTC
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"loadUsersBlacklist","level":"INFO","line":134,"message":"load users:1","timestamp":"2024-06-04 02:15:51"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"ERROR","line":121,"message":"unlock error: test unlock error","timestamp":"2024-06-04 02:15:51"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:52"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:52"}
2024/06/04 02:15:52 lockKey:test:begonia:user:black:lock
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:53"}
2024/06/04 02:15:53 lockKey:test:begonia:user:black:lock
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:53"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func2","level":"ERROR","line":89,"message":"lock error: context canceled","timestamp":"2024-06-04 02:15:53"}


[31m[0m[33m[0m[32m
139 total assertions[0m

--- PASS: TestHandleError (5.01s)
=== RUN   TestOnStart
2024/06/04 02:15:54 config dir: /data/work/begonia-org/begonia/config
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func2","level":"ERROR","line":89,"message":"lock error: context canceled","timestamp":"2024-06-04 02:15:54"}

  test data operator on start 2024/06/04 02:15:54 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"OnStart","level":"ERROR","line":178,"message":"init endpoints error,test endpoint watcher update error","timestamp":"2024-06-04 02:15:58"}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
143 total assertions[0m

--- PASS: TestOnStart (6.00s)
=== RUN   TestRefresh

  test data operator refresh 2024/06/04 02:16:00 config dir: /data/work/begonia-org/begonia/config
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:16:01"}
2024/06/04 02:16:01 lockKey:test:begonia:user:black:lock
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:16:01"}
2024/06/04 02:16:01 lastUpdate:2024-06-04 02:15:51.909 +0800 CST
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":123,"message":"unlock success","timestamp":"2024-06-04 02:16:01"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:16:02"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:16:02"}
2024/06/04 02:16:02 lockKey:test:begonia:user:black:lock
2024/06/04 02:16:02 lastUpdate:2024-06-04 02:15:51.909 +0800 CST
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":123,"message":"unlock success","timestamp":"2024-06-04 02:16:02"}


[31m[0m[33m[0m[32m
143 total assertions[0m

--- PASS: TestRefresh (3.00s)
=== RUN   TestUser
=== RUN   TestUser/testPutUser
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:16:03"}
2024/06/04 02:16:03 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:16:03 lockKey:test:begonia:user:black:lock
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:16:03"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func2","level":"ERROR","line":89,"message":"lock error: context canceled","timestamp":"2024-06-04 02:16:03"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func2","level":"ERROR","line":89,"message":"list app failed: context canceled","timestamp":"2024-06-04 02:16:03"}

  test user put success [32m✔[0m{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:16:04"}
2024/06/04 02:16:04 lockKey:test:begonia:user:black:lock
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:16:04"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func2","level":"ERROR","line":89,"message":"lock error: context canceled","timestamp":"2024-06-04 02:16:04"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func2","level":"ERROR","line":89,"message":"list app failed: context canceled","timestamp":"2024-06-04 02:16:04"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:16:05"}
2024/06/04 02:16:05 lockKey:test:begonia:user:black:lock
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:16:05"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func2","level":"ERROR","line":89,"message":"lock error: context canceled","timestamp":"2024-06-04 02:16:05"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func2","level":"ERROR","line":89,"message":"list app failed: context canceled","timestamp":"2024-06-04 02:16:05"}
[32m✔[0m

[31m[0m[33m[0m[32m
145 total assertions[0m


  test user put failed [32m✔[0m[32m✔[0m2024/06/04 02:16:05 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
149 total assertions[0m

=== RUN   TestUser/testGetUser
2024/06/04 02:16:05 config dir: /data/work/begonia-org/begonia/config

  test user get success [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
151 total assertions[0m


  test user get failed [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
153 total assertions[0m

=== RUN   TestUser/testPatchUser
2024/06/04 02:16:05 config dir: /data/work/begonia-org/begonia/config

  test user patch success [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
155 total assertions[0m


  test user patch failed [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:16:05 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
162 total assertions[0m

=== RUN   TestUser/testListUser
2024/06/04 02:16:05 config dir: /data/work/begonia-org/begonia/config

  test user list success [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
164 total assertions[0m


  test user list failed [32m✔[0m[32m✔[0m2024/06/04 02:16:06 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
170 total assertions[0m

=== RUN   TestUser/testDeleteUser
2024/06/04 02:16:06 config dir: /data/work/begonia-org/begonia/config

  test user delete success [32m✔[0m

[31m[0m[33m[0m[32m
171 total assertions[0m


  test user delete failed [32m✔[0m[32m✔[0m2024/06/04 02:16:06 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
175 total assertions[0m

--- PASS: TestUser (2.14s)
    --- PASS: TestUser/testPutUser (2.03s)
    --- PASS: TestUser/testGetUser (0.00s)
    --- PASS: TestUser/testPatchUser (0.01s)
    --- PASS: TestUser/testListUser (0.09s)
    --- PASS: TestUser/testDeleteUser (0.01s)
PASS
	github.com/begonia-org/begonia/internal/biz	coverage: 98.7% of statements
2024/06/04 02:16:06 All tests passed with code 0
ok  	github.com/begonia-org/begonia/internal/biz	25.102s	coverage: 98.7% of statements
=== RUN   TestEndpoint
=== RUN   TestEndpoint/Test_Add_Endpoint
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config

  Test Add Endpoint [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
3 total assertions[0m


  Test Add Endpoint Fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
9 total assertions[0m

=== RUN   TestEndpoint/Test_Watcher_Update
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config

  Test Watcher Update [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
11 total assertions[0m


  test watcher update fail [32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/internal/biz/endpoint/watcher.go","fn":"Update","level":"ERROR","line":48,"message":"get descriptor set error: rpc error: code = Internal desc = Failed to register: no gateway content","timestamp":"2024-06-04 02:15:41"}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
22 total assertions[0m

=== RUN   TestEndpoint/Test_Get_Endpoint
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config

  Test Get Endpoint Fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
29 total assertions[0m


  Test Get Endpoint [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
33 total assertions[0m

=== RUN   TestEndpoint/Test_Patch_Endpoint
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config

  Test Patch Endpoint [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
40 total assertions[0m


  Test Patch Endpoint Fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
52 total assertions[0m

=== RUN   TestEndpoint/Test_List_Endpoint
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config

  Test List Endpoint [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
78 total assertions[0m


  Test List Endpoint Fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
82 total assertions[0m

=== RUN   TestEndpoint/Test_Watcher_Del
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config

  Test Watcher Del [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
84 total assertions[0m


  test watcher del fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
91 total assertions[0m

=== RUN   TestEndpoint/Test_Del_Endpoint
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config

  Test Del Endpoint [32m✔[0m

[31m[0m[33m[0m[32m
92 total assertions[0m


  Test Del Endpoint Fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
96 total assertions[0m

--- PASS: TestEndpoint (0.41s)
    --- PASS: TestEndpoint/Test_Add_Endpoint (0.02s)
    --- PASS: TestEndpoint/Test_Watcher_Update (0.12s)
    --- PASS: TestEndpoint/Test_Get_Endpoint (0.00s)
    --- PASS: TestEndpoint/Test_Patch_Endpoint (0.03s)
    --- PASS: TestEndpoint/Test_List_Endpoint (0.19s)
    --- PASS: TestEndpoint/Test_Watcher_Del (0.04s)
    --- PASS: TestEndpoint/Test_Del_Endpoint (0.02s)
PASS
	github.com/begonia-org/begonia/internal/biz/endpoint	coverage: 98.7% of statements
ok  	github.com/begonia-org/begonia/internal/biz/endpoint	0.551s	coverage: 98.7% of statements
=== RUN   TestFile
=== RUN   TestFile/test_upload
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config

  test upload without version [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
5 total assertions[0m


  test upload with version [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
11 total assertions[0m


  test upload with version1 [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
17 total assertions[0m


  test upload with version2 [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
23 total assertions[0m


  test upload with version3 [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
29 total assertions[0m


  test upload with invalid key [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
31 total assertions[0m


  test upload with invalid author [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
33 total assertions[0m


  test upload fail with not match sha256 [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
35 total assertions[0m


  test upload fail     file_test.go:286: version:db64f957b53a3e214df71be460bd40d5db3e36d1,sha256:97cf7179f7eeaad7ed967dd9187bf4f1883c094f0ff9a62540377334fbccb57d
    file_test.go:286: version:6c5871c69a4d8ad21ee72282555d335938d766ad,sha256:e5f3f8a4f859807cb9d6bacd2c0a775e1e4a6f2f12637367feb65a695cbefd80
    file_test.go:286: version:424a3bea930c6046ed0129ee92fb84e59355e7d9,sha256:97cf7179f7eeaad7ed967dd9187bf4f1883c094f0ff9a62540377334fbccb57d
    file_test.go:286: version:362543f6d38f5794a8cb35846a0b75808b2d1bdb,sha256:97cf7179f7eeaad7ed967dd9187bf4f1883c094f0ff9a62540377334fbccb57d
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
47 total assertions[0m

=== RUN   TestFile/test_upload_version_commit_error
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config

  test upload version commit error     file_test.go:1217: test case 0
[32m✔[0m[32m✔[0m    file_test.go:1217: test case 1
[32m✔[0m[32m✔[0m    file_test.go:1217: test case 2
[32m✔[0m[32m✔[0m    file_test.go:1217: test case 3
[32m✔[0m[32m✔[0m    file_test.go:1217: test case 4
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m    file_test.go:1253: test upload version commit error end,rpc error: code = Internal desc = head error


[31m[0m[33m[0m[32m
61 total assertions[0m

=== RUN   TestFile/test_download
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config

  download success [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
64 total assertions[0m


  download with version1 [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
67 total assertions[0m


  download with version2 [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
70 total assertions[0m


  download with version3 [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
73 total assertions[0m


  download with latest version [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
76 total assertions[0m


  download fail with invalidate key [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
78 total assertions[0m


  download fail with version and invalidate key [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
80 total assertions[0m


  test download fail [32m✔[0m[32m✔[0m2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
    file_test.go:466: filepath:/tmp/upload/tester-20240604021541/test/upload.test2
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
89 total assertions[0m

=== RUN   TestFile/test_initiate_upload_file
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test init parts upload file success [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
93 total assertions[0m


  test init parts upload file fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
97 total assertions[0m

=== RUN   TestFile/test_upload_parts_file
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test upload parts file success 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  upload 452898186730672128 for 1 part 
  upload 452898186730672128 for 2 part [32m✔[0m

[31m[0m[33m[0m[32m
98 total assertions[0m


  upload 452898186730672128 for 3 part [32m✔[0m

[31m[0m[33m[0m[32m
99 total assertions[0m

[32m✔[0m

[31m[0m[33m[0m[32m
100 total assertions[0m


  upload 452898186730672128 for 4 part 
  upload 452898186730672128 for 5 part [32m✔[0m

[31m[0m[33m[0m[32m
101 total assertions[0m

[32m✔[0m

[31m[0m[33m[0m[32m
102 total assertions[0m


  upload 452898186730672128 for 6 part [32m✔[0m

[31m[0m[33m[0m[32m
103 total assertions[0m

[32m✔[0m

[31m[0m[33m[0m[32m
104 total assertions[0m


  test upload parts file fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
119 total assertions[0m

=== RUN   TestFile/test_complete_parts_file
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test complete parts file success [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
123 total assertions[0m


  test complete parts file fail [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:15:43 config dir: /data/work/begonia-org/begonia/config

  upload 452898190501351425 for 1 part [32m✔[0m

[31m[0m[33m[0m[32m
132 total assertions[0m

[32m✔[0m[32m✔[0m2024/06/04 02:15:43 config dir: /data/work/begonia-org/begonia/config

  upload 452898190614597632 for 1 part [32m✔[0m

[31m[0m[33m[0m[32m
135 total assertions[0m

[32m✔[0m[32m✔[0m2024/06/04 02:15:43 config dir: /data/work/begonia-org/begonia/config

  upload 452898190732038144 for 1 part [32m✔[0m

[31m[0m[33m[0m[32m
138 total assertions[0m

[32m✔[0m[32m✔[0m2024/06/04 02:15:43 config dir: /data/work/begonia-org/begonia/config

  upload 452898190845284352 for 1 part [32m✔[0m

[31m[0m[33m[0m[32m
141 total assertions[0m

[32m✔[0m[32m✔[0m2024/06/04 02:15:43 config dir: /data/work/begonia-org/begonia/config

  upload 452898190979502080 for 1 part [32m✔[0m

[31m[0m[33m[0m[32m
144 total assertions[0m

[32m✔[0m[32m✔[0m2024/06/04 02:15:43 config dir: /data/work/begonia-org/begonia/config

  upload 452898191113719808 for 1 part [32m✔[0m

[31m[0m[33m[0m[32m
147 total assertions[0m

[32m✔[0m[32m✔[0m2024/06/04 02:15:43 config dir: /data/work/begonia-org/begonia/config

  upload 452898191247937536 for 1 part [32m✔[0m

[31m[0m[33m[0m[32m
150 total assertions[0m

[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
152 total assertions[0m

=== RUN   TestFile/test_file_metadata
2024/06/04 02:15:43 config dir: /data/work/begonia-org/begonia/config

  test file metadata [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
160 total assertions[0m


  test file metadata fail [32m✔[0m[32m✔[0m2024/06/04 02:15:43 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
169 total assertions[0m

=== RUN   TestFile/test_version_reader
2024/06/04 02:15:44 config dir: /data/work/begonia-org/begonia/config

  test version reader [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
176 total assertions[0m


  test version reader fail 2024/06/04 02:15:44 config dir: /data/work/begonia-org/begonia/config
FAIL	github.com/begonia-org/begonia/internal/biz/file	3.433s
2024/06/04 02:15:41 Start testing
=== RUN   TestApp
=== RUN   TestApp/add_app

  test app add success     app_test.go:44: add test
2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
9 total assertions[0m

=== RUN   TestApp/get_app

  test app get success     app_test.go:109: get test
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
14 total assertions[0m

=== RUN   TestApp/get_appid

  test get appid 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
23 total assertions[0m

=== RUN   TestApp/test_cache

  test cache 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
26 total assertions[0m

=== RUN   TestApp/add_duplicate_name

  test app add duplicate name     app_test.go:129: add test
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
28 total assertions[0m

=== RUN   TestApp/patch_app

  test app patch success     app_test.go:158: patch test
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
37 total assertions[0m

=== RUN   TestApp/list_app
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test app list [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
60 total assertions[0m

=== RUN   TestApp/del_app

  test app delete success     app_test.go:313: delete test
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
68 total assertions[0m

--- PASS: TestApp (1.26s)
    --- PASS: TestApp/add_app (1.17s)
    --- PASS: TestApp/get_app (0.00s)
    --- PASS: TestApp/get_appid (0.00s)
    --- PASS: TestApp/test_cache (0.00s)
    --- PASS: TestApp/add_duplicate_name (0.00s)
    --- PASS: TestApp/patch_app (0.01s)
    --- PASS: TestApp/list_app (0.06s)
    --- PASS: TestApp/del_app (0.01s)
=== RUN   TestAuthzRepo
=== RUN   TestAuthzRepo/testCacheToken

  test cache token 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m

[31m[0m[33m[0m[32m
69 total assertions[0m

=== RUN   TestAuthzRepo/testGetToken
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  test get token [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
71 total assertions[0m


  test token expiration [32m✔[0m

[31m[0m[33m[0m[32m
72 total assertions[0m

=== RUN   TestAuthzRepo/deleteToken
2024/06/04 02:15:49 config dir: /data/work/begonia-org/begonia/config

  test delete exp token [32m✔[0m

[31m[0m[33m[0m[32m
73 total assertions[0m


  test token delete [32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/go-layered-cache/kv.go","fn":"Get","level":"ERROR","line":103,"message":"local.Get test:token2 error:Entry not found","timestamp":"2024-06-04 02:15:49"}
[32m✔[0m

[31m[0m[33m[0m[32m
76 total assertions[0m

=== RUN   TestAuthzRepo/testPutBlacklist
2024/06/04 02:15:49 config dir: /data/work/begonia-org/begonia/config

  test put blacklist [32m✔[0m

[31m[0m[33m[0m[32m
77 total assertions[0m

=== RUN   TestAuthzRepo/testCheckInBlackList
2024/06/04 02:15:49 config dir: /data/work/begonia-org/begonia/config

  test check in blacklist [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
81 total assertions[0m

--- PASS: TestAuthzRepo (7.01s)
    --- PASS: TestAuthzRepo/testCacheToken (0.00s)
    --- PASS: TestAuthzRepo/testGetToken (7.00s)
    --- PASS: TestAuthzRepo/deleteToken (0.00s)
    --- PASS: TestAuthzRepo/testPutBlacklist (0.00s)
    --- PASS: TestAuthzRepo/testCheckInBlackList (0.00s)
=== RUN   TestGetFromLocalErr

  test get from local err 2024/06/04 02:15:49 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
90 total assertions[0m

--- PASS: TestGetFromLocalErr (0.00s)
=== RUN   TestCacheWatch

  test cache watch 2024/06/04 02:15:49 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:49 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
93 total assertions[0m

--- PASS: TestCacheWatch (2.84s)
=== RUN   TestAssertDeletedModel

  test assert deleted model [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
101 total assertions[0m

--- PASS: TestAssertDeletedModel (0.00s)
=== RUN   TestGetPrimaryColumnValueErr

  test get primary column value err [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
105 total assertions[0m

--- PASS: TestGetPrimaryColumnValueErr (0.00s)
=== RUN   TestEndpoint
=== RUN   TestEndpoint/put

  test app add success     endpoint_test.go:33: add test
2024/06/04 02:15:52 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
111 total assertions[0m

=== RUN   TestEndpoint/checkServiceNameExistsTest

  test check service name exists 2024/06/04 02:15:52 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
116 total assertions[0m

=== RUN   TestEndpoint/get

  test endpoint get success 2024/06/04 02:15:52 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
120 total assertions[0m

=== RUN   TestEndpoint/getKeysByTags

  test get keys by tags success 2024/06/04 02:15:52 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
125 total assertions[0m

=== RUN   TestEndpoint/list
2024/06/04 02:15:52 config dir: /data/work/begonia-org/begonia/config
FAIL	github.com/begonia-org/begonia/internal/data	11.427s
=== RUN   TestStreamInterceptor

  test stream interceptor [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
2 total assertions[0m

--- PASS: TestStreamInterceptor (0.03s)
=== RUN   TestUnaryInterceptor

  test unary interceptor [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
32 total assertions[0m

--- PASS: TestUnaryInterceptor (0.05s)
=== RUN   TestMiddlewareUnaryInterceptorChains

  test middleware unary interceptor chains 2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin exception priority 0","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin http priority 2","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin params_validator priority 3","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin auth priority 4","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin logger priority 1","timestamp":"2024-06-04 02:15:42"}
[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin logger priority 1","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin exception priority 0","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin http priority 2","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin params_validator priority 3","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin auth priority 4","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin test priority 1","timestamp":"2024-06-04 02:15:42"}
[32m✔[0m{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin http priority 2","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin params_validator priority 3","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin auth priority 4","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin logger priority 1","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin exception priority 0","timestamp":"2024-06-04 02:15:42"}
[32m✔[0m

[31m[0m[33m[0m[32m
36 total assertions[0m

--- PASS: TestMiddlewareUnaryInterceptorChains (1.24s)
=== RUN   TestPluginUnaryInterceptor

  test plugin unary interceptor [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
43 total assertions[0m

--- PASS: TestPluginUnaryInterceptor (2.00s)
=== RUN   TestPluginUnaryInterceptorErr

  test plugin unary interceptor failed to listen: listen tcp :9850: bind: address already in use[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
59 total assertions[0m

--- PASS: TestPluginUnaryInterceptorErr (2.00s)
=== RUN   TestPluginStreamInterceptorErr

  test plugin unary interceptor failed to listen: listen tcp :9850: bind: address already in use[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
67 total assertions[0m

--- PASS: TestPluginStreamInterceptorErr (2.03s)
=== RUN   TestValidatorUnaryInterceptor

  test validator unary interceptor [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m    vaildator_test.go:59: rpc error: code = InvalidArgument desc = params SubName validation failed: 
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
74 total assertions[0m

--- PASS: TestValidatorUnaryInterceptor (0.00s)
=== RUN   TestValidatorStreamInterceptor

  test stream interceptor [32m✔[0m

[31m[0m[33m[0m[32m
75 total assertions[0m

--- PASS: TestValidatorStreamInterceptor (0.00s)
PASS
	github.com/begonia-org/begonia/internal/middleware	coverage: 99.3% of statements
ok  	github.com/begonia-org/begonia/internal/middleware	7.459s	coverage: 99.3% of statements
=== RUN   TestAccessKeyAuthMiddleware

  TestAccessKeyAuthMiddleware 2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/internal/middleware/auth/aksk.go","fn":"func1","level":"ERROR","line":108,"message":"StreamResponseAfter error,StreamResponseAfter err","timestamp":"2024-06-04 02:15:42"}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
6 total assertions[0m

--- PASS: TestAccessKeyAuthMiddleware (1.20s)
=== RUN   TestRequestBeforeErr

  TestRequestBeforeErr 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
13 total assertions[0m

--- PASS: TestRequestBeforeErr (0.00s)
=== RUN   TestValidateStream

  TestValidateStream 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
16 total assertions[0m

--- PASS: TestValidateStream (0.00s)
=== RUN   TestAPIKeyUnaryInterceptor

  TestAPIKeyUnaryInterceptor 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
23 total assertions[0m

--- PASS: TestAPIKeyUnaryInterceptor (0.02s)
=== RUN   TestApiKeyStreamInterceptor

  TestApiKeyStreamInterceptor 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
27 total assertions[0m

--- PASS: TestApiKeyStreamInterceptor (0.02s)
=== RUN   TestUnaryInterceptor
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  TestUnaryInterceptor api-key [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
31 total assertions[0m


  TestUnaryInterceptor jwt 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
{"file":"/data/work/begonia-org/go-layered-cache/cuckoo.go","fn":"Check","level":"ERROR","line":100,"message":"local.Get test:begonia:filter:user:black error:not found such bloom filter test:begonia:filter:user:black","timestamp":"2024-06-04 02:15:42"}
{"file":"/data/work/begonia-org/begonia/internal/data/cache.go","fn":"CheckInFilter","level":"ERROR","line":98,"message":"check value of test:begonia:filter:user:black error:not found such bloom filter test:begonia:filter:user:black","timestamp":"2024-06-04 02:15:42"}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
33 total assertions[0m


  TestUnaryInterceptor aksk [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
40 total assertions[0m

--- PASS: TestUnaryInterceptor (0.03s)
=== RUN   TestStreamInterceptor
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  TestStreamInterceptor apikey [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
42 total assertions[0m


  TestStreamInterceptor jwt 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
44 total assertions[0m


  TestUnaryInterceptor aksk [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
51 total assertions[0m

--- PASS: TestStreamInterceptor (0.03s)
=== RUN   TestTestUnaryInterceptorErr
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  TestUnaryInterceptor err [32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
54 total assertions[0m

--- PASS: TestTestUnaryInterceptorErr (0.02s)
=== RUN   TestStreamInterceptorErr
2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config

  TestStreamInterceptor err [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
59 total assertions[0m

--- PASS: TestStreamInterceptorErr (0.03s)
=== RUN   TestHeaders

  TestHeaders [32m✔[0m

[31m[0m[33m[0m[32m
60 total assertions[0m

--- PASS: TestHeaders (0.00s)
=== RUN   TestJWTUnaryInterceptor

  TestJWTUnaryInterceptor 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/internal/middleware/auth/jwt.go","fn":"func1","level":"ERROR","line":130,"message":"refresh token fail,test","timestamp":"2024-06-04 02:15:56","x-access-key":"","x-http-forwarded-for":"","x-http-method":"","x-http-uri":"","x-request-id":"","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
89 total assertions[0m

--- PASS: TestJWTUnaryInterceptor (13.44s)
=== RUN   TestJWTStreamInterceptor

  TestJWTStreamInterceptor 2024/06/04 02:15:56 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
93 total assertions[0m

--- PASS: TestJWTStreamInterceptor (0.02s)
PASS
	github.com/begonia-org/begonia/internal/middleware/auth	coverage: 98.7% of statements
ok  	github.com/begonia-org/begonia/internal/middleware/auth	14.915s	coverage: 98.7% of statements
=== RUN   TestConstant
    constant_test.go:11: TestConstant

  TestConstant [32m✔[0m

[31m[0m[33m[0m[32m
1 total assertion[0m

--- PASS: TestConstant (0.00s)
PASS
	github.com/begonia-org/begonia/internal/pkg	coverage: [no statements]
ok  	github.com/begonia-org/begonia/internal/pkg	0.029s	coverage: [no statements]
=== RUN   TestConfig

  TestConfig 2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:15:41 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
65 total assertions[0m

--- PASS: TestConfig (0.01s)
PASS
	github.com/begonia-org/begonia/internal/pkg/config	coverage: 97.2% of statements
ok  	github.com/begonia-org/begonia/internal/pkg/config	0.065s	coverage: 97.2% of statements
=== RUN   TestGenerateRandPasswd

  TestGenerateRandPasswd 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
5 total assertions[0m

--- PASS: TestGenerateRandPasswd (0.00s)
=== RUN   TestNewUsersAuth

  TestNewUsersAuth 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
9 total assertions[0m

--- PASS: TestNewUsersAuth (0.00s)
=== RUN   TestGenerateRandSeed

  TestGenerateRandSeed 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m

[31m[0m[33m[0m[32m
10 total assertions[0m

--- PASS: TestGenerateRandSeed (0.00s)
=== RUN   TestGenerateKeys

  TestGenerateKeys 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
16 total assertions[0m

--- PASS: TestGenerateKeys (0.02s)
=== RUN   TestEncryptWithPublicKey

  TestEncrypt With PublicKey 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
25 total assertions[0m

--- PASS: TestEncryptWithPublicKey (0.04s)
=== RUN   TestEncryptAES

  TestEncryptAES 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
31 total assertions[0m

--- PASS: TestEncryptAES (0.00s)
=== RUN   TestGenerateAuthSeed

  TestGenerateAuthSeed 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
39 total assertions[0m

--- PASS: TestGenerateAuthSeed (0.00s)
=== RUN   TestRSADecrypt

  TestRSADecrypt 2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
46 total assertions[0m

--- PASS: TestRSADecrypt (0.01s)
PASS
	github.com/begonia-org/begonia/internal/pkg/crypto	coverage: 100.0% of statements
ok  	github.com/begonia-org/begonia/internal/pkg/crypto	0.148s	coverage: 100.0% of statements
=== RUN   TestLoadAllRouters

  TestLoadAllRouters [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
8 total assertions[0m

--- PASS: TestLoadAllRouters (0.03s)
=== RUN   TestDeleteRouters

  TestDeleteRouters [32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
10 total assertions[0m

--- PASS: TestDeleteRouters (0.03s)
PASS
	github.com/begonia-org/begonia/internal/pkg/routers	coverage: 97.0% of statements
ok  	github.com/begonia-org/begonia/internal/pkg/routers	0.090s	coverage: 97.0% of statements
=== RUN   TestGenerateRandomString

  TestGenerateRandomString [32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
4 total assertions[0m

--- PASS: TestGenerateRandomString (0.00s)
=== RUN   TestLoadPublicKeyFromFile

  TestLoadPublicKeyFromFile [32m✔[0m[32m✔[0m2024/06/04 02:15:42 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
14 total assertions[0m

--- PASS: TestLoadPublicKeyFromFile (0.00s)
PASS
	github.com/begonia-org/begonia/internal/pkg/utils	coverage: 100.0% of statements
ok  	github.com/begonia-org/begonia/internal/pkg/utils	0.022s	coverage: 100.0% of statements
2024/06/04 02:15:43 run test server
2024/06/04 02:15:43 config dir: /data/work/begonia-org/begonia/config
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin logger priority 1","timestamp":"2024-06-04 02:15:44"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin exception priority 0","timestamp":"2024-06-04 02:15:44"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin http priority 2","timestamp":"2024-06-04 02:15:44"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin params_validator priority 3","timestamp":"2024-06-04 02:15:44"}
{"file":"/data/work/begonia-org/begonia/internal/middleware/middleware.go","fn":"New","level":"INFO","line":49,"message":"plugin auth priority 4","timestamp":"2024-06-04 02:15:44"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"Do","level":"INFO","line":62,"message":"start watch","timestamp":"2024-06-04 02:15:44"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:44"}
2024/06/04 02:15:44 lockKey:test:begonia:user:black:lock
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":81,"message":"start action","timestamp":"2024-06-04 02:15:44"}
2024/06/04 02:15:44 lastUpdate:2024-06-04 02:15:42.904 +0800 CST
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"loadUsersBlacklist","level":"INFO","line":134,"message":"load users:1","timestamp":"2024-06-04 02:15:44"}
{"file":"/data/work/begonia-org/begonia/internal/biz/data.go","fn":"func1","level":"INFO","line":123,"message":"unlock success","timestamp":"2024-06-04 02:15:44"}
2024/06/04 02:15:47 Start on 0.0.0.0:12140
=== RUN   TestApp
=== RUN   TestApp/add_app

  test add app {"elapsed":"18.215954ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AppsService/Post","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/apps","x-request-id":"2a8266ba-aaa8-4026-9929-b585c85af860","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m{"elapsed":"607.458µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AppsService/Get","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/apps/452898220301881344","x-request-id":"101c4cc6-0c72-47d9-b379-20498355bd4a","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m{"elapsed":"2.650465ms","file":"/data/work/begonia-org/begonia/internal/biz/app.go","fn":"github.com/begonia-org/begonia/internal/biz.(*AppUsecase).Put.func1","level":"ERROR","line":105,"message":"rpc error: code = AlreadyExists desc = add app failed: Error 1062 (23000): Duplicate entry 'app-20240604021550' for key 'apps.uni_apps_name'","module":"request","name":"/begonia.org.sdk.AppsService/Post","status":5102,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/apps","x-request-id":"0b024ba9-7489-4cb1-9dc0-f17e55bd3e4d","x-uid":""}
{"file":"/data/work/begonia-org/begonia/internal/biz/app.go","fn":"github.com/begonia-org/begonia/internal/biz.(*AppUsecase).Put.func1","level":"ERROR","line":105,"message":"add app failed: Error 1062 (23000): Duplicate entry 'app-20240604021550' for key 'apps.uni_apps_name'","status":409,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1:36978","x-http-method":"POST","x-http-uri":"/api/v1/apps","x-request-id":"b221f85e-0111-454d-bceb-4f93d6b0a1bd","x-uid":""}
[32m✔[0m[32m✔[0m{"elapsed":"5.081279ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AppsService/Post","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/apps","x-request-id":"921caa30-2a54-4635-8467-4d21685d941c","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
10 total assertions[0m

=== RUN   TestApp/get_app

  test get app {"elapsed":"560.001µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AppsService/Get","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/apps/452898220301881344","x-request-id":"2b5497a1-772c-43ac-b0af-0014f9cbe508","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
12 total assertions[0m

=== RUN   TestApp/list_app

  test list app {"elapsed":"4.020027ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AppsService/List","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/apps?page=1\u0026page_size=10\u0026status=APP_ENABLED\u0026tags=test\u0026tags=test2","x-request-id":"f3e668a9-ef3e-4948-92ca-865d791eb0f7","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
16 total assertions[0m

=== RUN   TestApp/list_app_err

  test list app 2024/06/04 02:15:50 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
18 total assertions[0m

=== RUN   TestApp/patch_app

  test patch app {"elapsed":"5.094546ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AppsService/Update","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"PUT","x-http-uri":"/api/v1/apps","x-request-id":"cff9c8e8-a6e3-4c15-84c9-0e9fb109e9ca","x-uid":""}
[32m✔[0m[32m✔[0m{"elapsed":"483.604µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AppsService/Get","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/apps/452898220301881344","x-request-id":"e70294a2-f9c8-4e5f-8c94-63b4617d486e","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m{"elapsed":"3.001971ms","file":"/data/work/begonia-org/begonia/internal/biz/app.go","fn":"github.com/begonia-org/begonia/internal/biz.(*AppUsecase).Patch","level":"ERROR","line":166,"message":"rpc error: code = Internal desc = update model for appid=452898220301881344 failed: Error 1062 (23000): Duplicate entry 'app-service-2-20240604021550' for key 'apps.uni_apps_name'","module":"request","name":"/begonia.org.sdk.AppsService/Update","status":5102,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"PUT","x-http-uri":"/api/v1/apps","x-request-id":"bc9ff890-eee8-4950-922e-31593bc94d53","x-uid":""}
{"file":"/data/work/begonia-org/begonia/internal/biz/app.go","fn":"github.com/begonia-org/begonia/internal/biz.(*AppUsecase).Patch","level":"ERROR","line":166,"message":"update model for appid=452898220301881344 failed: Error 1062 (23000): Duplicate entry 'app-service-2-20240604021550' for key 'apps.uni_apps_name'","status":500,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1:36978","x-http-method":"PUT","x-http-uri":"/api/v1/apps","x-request-id":"05d8846c-1e95-4a96-930e-d86715d25045","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
25 total assertions[0m

=== RUN   TestApp/del_app

  test del app {"elapsed":"5.470225ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AppsService/Delete","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"DELETE","x-http-uri":"/api/v1/apps/452898220301881344","x-request-id":"13a42d6f-1e4c-4d66-817f-d9186c273ee7","x-uid":""}
[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/internal/service/app.go","fn":"Get","level":"ERROR","line":34,"message":"GetApps failed: rpc error: code = NotFound desc = get app failed: get model failed: record not found","timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/apps/452898220301881344","x-request-id":"49aa4aac-8d2f-4789-8582-a797e6c9a6fa","x-uid":""}
{"elapsed":"641.822µs","file":"/data/work/begonia-org/begonia/internal/biz/app.go","fn":"github.com/begonia-org/begonia/internal/biz.(*AppUsecase).Get","level":"ERROR","line":131,"message":"rpc error: code = NotFound desc = get app failed: get model failed: record not found","module":"request","name":"/begonia.org.sdk.AppsService/Get","status":5108,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/apps/452898220301881344","x-request-id":"49aa4aac-8d2f-4789-8582-a797e6c9a6fa","x-uid":""}
{"file":"/data/work/begonia-org/begonia/internal/biz/app.go","fn":"github.com/begonia-org/begonia/internal/biz.(*AppUsecase).Get","level":"ERROR","line":131,"message":"get app failed: get model failed: record not found","status":404,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1:36978","x-http-method":"GET","x-http-uri":"/api/v1/apps/452898220301881344","x-request-id":"323a21b4-8b6f-4b4e-ada1-78492d358c28","x-uid":""}
[32m✔[0m{"elapsed":"432.914µs","file":"/data/work/begonia-org/begonia/internal/biz/app.go","fn":"github.com/begonia-org/begonia/internal/biz.(*AppUsecase).Del","level":"ERROR","line":145,"message":"rpc error: code = NotFound desc = get app failed: get model failed: record not found","module":"request","name":"/begonia.org.sdk.AppsService/Delete","status":5108,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"DELETE","x-http-uri":"/api/v1/apps/452898220301881344","x-request-id":"23831134-0c21-4328-b8aa-28239a82847c","x-uid":""}
{"file":"/data/work/begonia-org/begonia/internal/biz/app.go","fn":"github.com/begonia-org/begonia/internal/biz.(*AppUsecase).Del","level":"ERROR","line":145,"message":"get app failed: get model failed: record not found","status":404,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1:36978","x-http-method":"DELETE","x-http-uri":"/api/v1/apps/452898220301881344","x-request-id":"4af9eddf-c94c-492f-9c29-73ac87b30efb","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
30 total assertions[0m

--- PASS: TestApp (0.07s)
    --- PASS: TestApp/add_app (0.03s)
    --- PASS: TestApp/get_app (0.00s)
    --- PASS: TestApp/list_app (0.01s)
    --- PASS: TestApp/list_app_err (0.00s)
    --- PASS: TestApp/patch_app (0.01s)
    --- PASS: TestApp/del_app (0.01s)
=== RUN   TestAuth
=== RUN   TestAuth/login

  test login [32m✔[0m{"elapsed":"72.428µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AuthService/AuthSeed","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/auth/log/1717438550227000","x-request-id":"2d103137-9824-4e11-a25b-fdec472583a8","x-uid":""}
{"elapsed":"2.339ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AuthService/Login","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/auth/login","x-request-id":"5bc9be20-60a3-450c-b0bb-50745c0c3fe5","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/go-layered-cache/cuckoo.go","fn":"Check","level":"ERROR","line":100,"message":"local.Get test:begonia:filter:user:black error:not found such bloom filter test:begonia:filter:user:black","timestamp":"2024-06-04 02:15:50"}
{"file":"/data/work/begonia-org/begonia/internal/data/cache.go","fn":"CheckInFilter","level":"ERROR","line":98,"message":"check value of test:begonia:filter:user:black error:not found such bloom filter test:begonia:filter:user:black","timestamp":"2024-06-04 02:15:50"}
{"elapsed":"994ns","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.SystemService/Get","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/v1/gateway/info","x-request-id":"1f0327a1-c1f6-4150-904b-c44c209d4630","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m    authz_test.go:92: test-20240507141004 20240604021539 e5fe9d5


[31m[0m[33m[0m[32m
41 total assertions[0m

=== RUN   TestAuth/logout

  test logout {"file":"/data/work/begonia-org/go-layered-cache/cuckoo.go","fn":"Add","level":"ERROR","line":111,"message":"source.Set:context canceled","timestamp":"2024-06-04 02:15:50"}
{"elapsed":"4.748µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"ERROR","line":161,"message":"logout error","module":"request","name":"/begonia.org.sdk.AuthService/Logout","status":500,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"DELETE","x-http-uri":"/api/v1/auth/logout","x-request-id":"d7075c07-cbce-4c3c-9ed3-49003816516e","x-uid":""}
{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"logout error","status":500,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1:36978","x-http-method":"DELETE","x-http-uri":"/api/v1/auth/logout","x-request-id":"e4149e49-6aff-4b9a-9d7c-fd277baa11e9","x-uid":""}
[32m✔[0m{"elapsed":"106.297µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.AuthService/Logout","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"DELETE","x-http-uri":"/api/v1/auth/logout","x-request-id":"b404ce71-3a74-4f36-9bd7-523d46ea8882","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"check token error,rpc error: code = Unauthenticated desc = token在黑名单中 or %!!(MISSING)w(\u003cnil\u003e)","status":401,"timestamp":"2024-06-04 02:15:50","x-access-key":"","x-http-forwarded-for":"127.0.0.1:36978","x-http-method":"GET","x-http-uri":"/v1/gateway/info","x-request-id":"f6165060-30fa-4e3f-8fe9-db76c795dda0","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"func1","level":"ERROR","line":279,"message":"check token error,rpc error: code = Unauthenticated desc = token在黑名单中 or %!!(MISSING)w(\u003cnil\u003e)","status":401,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1:36978","x-http-method":"DELETE","x-http-uri":"/api/v1/auth/logout","x-request-id":"a11d16a8-2d57-4e7b-81c8-499113e57b37","x-uid":""}
[32m✔[0m    authz_test.go:130: logout error: Unknown error


[31m[0m[33m[0m[32m
50 total assertions[0m

=== RUN   TestAuth/auth_seed

  test auth seed 2024/06/04 02:15:50 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m

[31m[0m[33m[0m[32m
51 total assertions[0m

--- PASS: TestAuth (0.01s)
    --- PASS: TestAuth/login (0.01s)
    --- PASS: TestAuth/logout (0.00s)
    --- PASS: TestAuth/auth_seed (0.00s)
=== RUN   TestFile
=== RUN   TestFile/upload

  test upload file {"elapsed":"9.173166ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/Upload","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/files","x-request-id":"6b27c120-b615-4eec-8493-7cba5d580f10","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:15:50 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
58 total assertions[0m

=== RUN   TestFile/download

  test download file [32m✔[0m{"elapsed":"101.307µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/Download","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/files?key=449250203195674624%2Ftest%2Fhelloworld.pb","x-request-id":"b75d399d-a6de-4234-8db2-a1b93db212cb","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m    file_test.go:188: 8b8812a5661179bef9ef057ec3c448cf244f9ddf6bd669bfd681e5696ae616be
[32m✔[0m

[31m[0m[33m[0m[32m
63 total assertions[0m

=== RUN   TestFile/testUploadErr

  test upload file err 2024/06/04 02:15:50 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
67 total assertions[0m

=== RUN   TestFile/testDownloadErr

  test download file err 2024/06/04 02:15:50 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
73 total assertions[0m

=== RUN   TestFile/uploadParts

  test upload file [32m✔[0m{"elapsed":"84.459µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/InitiateMultipartUpload","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/files/part/init","x-request-id":"13a68ff6-eafa-43b0-b3e7-43885fe00399","x-uid":""}
{"elapsed":"8.583913ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/UploadMultipartFile","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"PUT","x-http-uri":"/api/v1/files/part","x-request-id":"49ba1ed2-7b6b-4346-8b46-cfdbf2e8a226","x-uid":""}
{"elapsed":"77.537552ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/CompleteMultipartUpload","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/files/part/complete","x-request-id":"9a9f3e77-1571-4d6e-a5c3-83ce4442ed7b","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m2024/06/04 02:15:50 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
80 total assertions[0m

=== RUN   TestFile/testRangeDownload

  test range download file [32m✔[0m{"elapsed":"39.56µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/DownloadForRange","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/files/part?key=449250203195674624%2Ftest%2Ftmp.bin","x-request-id":"7664bf2e-671b-46f0-9048-b03b83148450","x-uid":""}
[32m✔[0m[32m✔[0m{"elapsed":"1.15571ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/DownloadForRange","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/files/part?key=449250203195674624%2Ftest%2Ftmp.bin","x-request-id":"15b694e6-f56a-4196-8721-fe99a56dcd20","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
85 total assertions[0m

=== RUN   TestFile/testAbortUpload

  test range download file {"elapsed":"26.185µs","file":"/data/work/begonia-org/begonia/internal/biz/file/file.go","fn":"github.com/begonia-org/begonia/internal/biz/file.(*FileUsecase).AbortMultipartUpload","level":"ERROR","line":356,"message":"rpc error: code = NotFound desc = uploadId未找到","module":"request","name":"/begonia.org.sdk.FileService/AbortMultipartUpload","status":6105,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/files/part/abort","x-request-id":"0408a40c-7fca-4386-9bc6-3514ea06b2be","x-uid":""}
{"file":"/data/work/begonia-org/begonia/internal/biz/file/file.go","fn":"github.com/begonia-org/begonia/internal/biz/file.(*FileUsecase).AbortMultipartUpload","level":"ERROR","line":356,"message":"uploadId未找到","status":404,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1:36978","x-http-method":"POST","x-http-uri":"/api/v1/files/part/abort","x-request-id":"d178acb6-40e5-49b8-8d70-0ada02a56f87","x-uid":""}
[32m✔[0m

[31m[0m[33m[0m[32m
86 total assertions[0m

=== RUN   TestFile/testRangeDownloadErr

  test range download file err 2024/06/04 02:15:50 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
102 total assertions[0m

=== RUN   TestFile/downloadParts

  test download parts file [32m✔[0m{"elapsed":"23.464014ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/Metadata","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"HEAD","x-http-uri":"/api/v1/files/metadata?key=449250203195674624%2Ftest%2Ftmp.bin","x-request-id":"5b6644d5-fb0f-4210-815a-d0010fe4a866","x-uid":""}
{"elapsed":"761.613µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/DownloadForRange","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/files/part?key=449250203195674624%2Ftest%2Ftmp.bin","x-request-id":"3b8455cb-4ba0-4974-af52-9048a0f9998f","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
105 total assertions[0m

=== RUN   TestFile/deleteFile

  test delete file {"elapsed":"431.63µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.FileService/Delete","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"DELETE","x-http-uri":"/api/v1/files?key=449250203195674624%2Ftest%2Fhelloworld.pb","x-request-id":"a86316bf-a48b-45a0-bf50-a77087a8f6fe","x-uid":""}
[32m✔[0m[32m✔[0m2024/06/04 02:15:50 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m

[31m[0m[33m[0m[32m
108 total assertions[0m

=== RUN   TestFile/testDelErr

  test delete file err 2024/06/04 02:15:50 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
110 total assertions[0m

=== RUN   TestFile/testMetaErr

  test meta file err 2024/06/04 02:15:50 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
114 total assertions[0m

--- PASS: TestFile (0.32s)
    --- PASS: TestFile/upload (0.01s)
    --- PASS: TestFile/download (0.00s)
    --- PASS: TestFile/testUploadErr (0.00s)
    --- PASS: TestFile/testDownloadErr (0.00s)
    --- PASS: TestFile/uploadParts (0.24s)
    --- PASS: TestFile/testRangeDownload (0.01s)
    --- PASS: TestFile/testAbortUpload (0.00s)
    --- PASS: TestFile/testRangeDownloadErr (0.00s)
    --- PASS: TestFile/downloadParts (0.05s)
    --- PASS: TestFile/deleteFile (0.00s)
    --- PASS: TestFile/testDelErr (0.00s)
    --- PASS: TestFile/testMetaErr (0.00s)
=== RUN   TestEndpoint
=== RUN   TestEndpoint/post

  test create endpoint api [32m✔[0m{"elapsed":"16.567491ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.EndpointService/Post","status":200,"timestamp":"2024-06-04 02:15:50","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/endpoints","x-request-id":"75434e91-87e4-45ef-8f3f-95249524599f","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m{"elapsed":"1.951039ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/helloworld.Greeter/SayHelloGet","status":200,"timestamp":"2024-06-04 02:15:51","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/helloworld","x-request-id":"f63a0520-d59c-45e3-8c8b-c71b363b0fb2","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
121 total assertions[0m

=== RUN   TestEndpoint/patch

  test patch endpoint api {"elapsed":"14.741349ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.EndpointService/Update","status":200,"timestamp":"2024-06-04 02:15:51","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"PUT","x-http-uri":"/api/v1/endpoints/452898221971214336","x-request-id":"38cf3924-c8ef-4f39-a3f0-3641ca7273eb","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
123 total assertions[0m

=== RUN   TestEndpoint/get

  test get endpoint api {"elapsed":"581.154µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.EndpointService/Get","status":200,"timestamp":"2024-06-04 02:15:54","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/endpoints/452898221971214336","x-request-id":"feb1929a-a241-4a6e-9a1a-2fb54ecd486a","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
126 total assertions[0m

=== RUN   TestEndpoint/list

  test list endpoint api {"elapsed":"5.844533ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.EndpointService/List","status":200,"timestamp":"2024-06-04 02:15:54","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/endpoints?tags=test\u0026tags=test2","x-request-id":"ca1e3a41-3a85-4c6b-a1e6-00019a47a777","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
129 total assertions[0m

=== RUN   TestEndpoint/testErr

  test endpoint server error 2024/06/04 02:15:54 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
135 total assertions[0m

=== RUN   TestEndpoint/del

  test delete endpoint api {"elapsed":"16.479626ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.EndpointService/Delete","status":200,"timestamp":"2024-06-04 02:15:54","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"DELETE","x-http-uri":"/api/v1/endpoints/452898221971214336","x-request-id":"9ba336b5-f04c-4d92-86ee-d108abaf6608","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m{"file":"/data/work/begonia-org/begonia/gateway/http.go","fn":"func1","level":"WARNING","line":363,"message":"not found router","timestamp":"2024-06-04 02:15:59","x-access-key":"","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/example/helloworld","x-request-id":"ff4cf145-09af-4989-ad34-331fdd2d4bc3","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
140 total assertions[0m

--- PASS: TestEndpoint (9.09s)
    --- PASS: TestEndpoint/post (1.02s)
    --- PASS: TestEndpoint/patch (3.02s)
    --- PASS: TestEndpoint/get (0.00s)
    --- PASS: TestEndpoint/list (0.02s)
    --- PASS: TestEndpoint/testErr (0.00s)
    --- PASS: TestEndpoint/del (5.02s)
=== RUN   TestUser
=== RUN   TestUser/add_user

  test add user {"elapsed":"14.530642ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.UserService/Register","status":200,"timestamp":"2024-06-04 02:15:59","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"POST","x-http-uri":"/api/v1/users","x-request-id":"1c256560-de82-4608-b55a-592bb2f1fa94","x-uid":""}
[32m✔[0m[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
143 total assertions[0m

=== RUN   TestUser/get_user

  test get user {"elapsed":"457.003µs","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.UserService/Get","status":200,"timestamp":"2024-06-04 02:15:59","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/users/452898260093243392","x-request-id":"6a424e71-5f3b-4f21-8baa-9f0a89c7971e","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
145 total assertions[0m

=== RUN   TestUser/patch_user

  test patch user {"elapsed":"5.001363ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.UserService/Update","status":200,"timestamp":"2024-06-04 02:15:59","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"PUT","x-http-uri":"/api/v1/users/452898260093243392","x-request-id":"fef2ea43-1d7b-4a54-a9a3-e9c63c7cbe89","x-uid":""}
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
147 total assertions[0m

=== RUN   TestUser/delete_user

  test delete user {"elapsed":"4.923405ms","file":"/data/work/begonia-org/begonia/gateway/middlewares.go","fn":"logger","level":"INFO","line":163,"message":"success","module":"request","name":"/begonia.org.sdk.UserService/Delete","status":200,"timestamp":"2024-06-04 02:15:59","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"DELETE","x-http-uri":"/api/v1/users/452898260093243392","x-request-id":"1c52ebce-95bf-4184-a516-25407c9079ad","x-uid":""}
[32m✔[0m[32m✔[0m{"elapsed":"367.879µs","file":"/data/work/begonia-org/begonia/internal/biz/user.go","fn":"github.com/begonia-org/begonia/internal/biz.(*UserUsecase).Get","level":"ERROR","line":58,"message":"rpc error: code = NotFound desc = get user failed: get model failed: record not found","module":"request","name":"/begonia.org.sdk.UserService/Get","status":4113,"timestamp":"2024-06-04 02:15:59","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1","x-http-method":"GET","x-http-uri":"/api/v1/users/452898260093243392","x-request-id":"96c099f0-c3b1-4ea3-8ff4-dede488f9f89","x-uid":""}
{"file":"/data/work/begonia-org/begonia/internal/biz/user.go","fn":"github.com/begonia-org/begonia/internal/biz.(*UserUsecase).Get","level":"ERROR","line":58,"message":"get user failed: get model failed: record not found","status":404,"timestamp":"2024-06-04 02:15:59","x-access-key":"P6DKyCxyz2ewz4brsFPJtusyMLYh4uex","x-http-forwarded-for":"127.0.0.1:36986","x-http-method":"GET","x-http-uri":"/api/v1/users/452898260093243392","x-request-id":"bad74af4-7264-4b8f-88d3-c6bff84cc584","x-uid":""}
[32m✔[0m

[31m[0m[33m[0m[32m
150 total assertions[0m

=== RUN   TestUser/test_register_user_error

  test register user error 2024/06/04 02:15:59 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
152 total assertions[0m

=== RUN   TestUser/test_update_user_error

  test update user error 2024/06/04 02:15:59 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
154 total assertions[0m

=== RUN   TestUser/test_delete_user_error

  test delete user error 2024/06/04 02:15:59 config dir: /data/work/begonia-org/begonia/config
[32m✔[0m[32m✔[0m

[31m[0m[33m[0m[32m
156 total assertions[0m

--- PASS: TestUser (0.03s)
    --- PASS: TestUser/add_user (0.02s)
    --- PASS: TestUser/get_user (0.00s)
    --- PASS: TestUser/patch_user (0.01s)
    --- PASS: TestUser/delete_user (0.01s)
    --- PASS: TestUser/test_register_user_error (0.00s)
    --- PASS: TestUser/test_update_user_error (0.00s)
    --- PASS: TestUser/test_delete_user_error (0.00s)
PASS
	github.com/begonia-org/begonia/internal/service	coverage: 97.5% of statements
2024/06/04 02:15:59 All tests passed
ok  	github.com/begonia-org/begonia/internal/service	26.704s	coverage: 97.5% of statements
FAIL
